{% extends 'base.html' %}
{% load static %}

{% block title %}Home - Design System{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="home-hero">
    <div class="hero-container">
        <div class="hero-content">
            <div class="hero-text">
                <div class="hero-welcome">Welcome to</div>
                <h1 class="hero-title">UAP-CSE</h1>
                <div class="hero-tagline">Committed to excellence...</div>
                <div class="hero-stats">
                    <!-- <span class="stats-prefix">We have</span> -->
                    <span class="stats-dynamic" id="dynamicStats">
                        {% if hero_tags.first %}
                            {{ hero_tags.first.title }}
                        {% else %}
                            Loading...
                        {% endif %}
                    </span>
                </div>
            </div>
            <div class="hero-visuals">
                <div class="polaroid-container">
                    {% for card in feature_cards %}
                    <a href="{% url 'designs:feature_card_detail' card.pk %}" class="polaroid-link polaroid-{{ forloop.counter }}">
                        <div class="polaroid-frame polaroid-{{ forloop.counter }}">
                            <div class="polaroid-image">
                                {% if card.picture %}
                                    <img src="/media/{{ card.picture.name }}" alt="{{ card.title }}">
                                {% endif %}
                            </div>
                            <div class="polaroid-caption">{{ card.caption }}</div>
                        </div>
                    </a>
                    {% empty %}
                    <!-- Fallback if no feature cards -->
                    <div class="polaroid-frame polaroid-1">
                        <div class="polaroid-image"></div>
                        <div class="polaroid-caption">Student Life</div>
                    </div>
                    <div class="polaroid-frame polaroid-2">
                        <div class="polaroid-image"></div>
                        <div class="polaroid-caption">Innovation</div>
                    </div>
                    <div class="polaroid-frame polaroid-3">
                        <div class="polaroid-image"></div>
                        <div class="polaroid-caption">Community</div>
                    </div>
                    {% endfor %}
                </div>
                <div class="hero-greeting">
                    <!-- <br> -->
                    <!-- <span class="brief-text" id="briefText">Whats up?</span> -->
                </div>
            </div>
        </div>
    </div>
</section>

<div class="container">

    <!-- Color Test Section -->
    <section class="color-test-section">
        <h2>Color Palette</h2>
        <p>Soothing color system with lavender and cyan themes. Click the theme toggle to cycle through light lavender, dark lavender, and cyan themes.</p>
        
        <div class="color-cards-grid">
            <!-- Bright Lavender (Light Theme) -->
            <div class="color-card">
                <div class="color-card-header">
                    <h3 class="color-card-title">Bright Lavender</h3>
                    <div class="color-swatch color-primary"></div>
                </div>
                <div class="color-card-body">
                    <p><strong>Main:</strong> <span class="color-code">var(--color-primary)</span></p>
                    <p><strong>Hover:</strong> <span class="color-code">var(--color-primary-hover)</span></p>
                    <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-secondary);">Used in light theme</p>
                </div>
                <div class="color-variant">
                    <div class="color-variant-swatch color-primary-light"></div>
                    <div class="color-variant-info">
                        <div class="color-variant-name">Light Variant</div>
                        <div class="color-variant-code">--color-primary-light</div>
                    </div>
                </div>
                <div class="color-variant">
                    <div class="color-variant-swatch color-primary-dark"></div>
                    <div class="color-variant-info">
                        <div class="color-variant-name">Dark Variant</div>
                        <div class="color-variant-code">--color-primary-dark</div>
                    </div>
                </div>
            </div>

            <!-- Dark Lavender (Dark Theme) -->
            <div class="color-card">
                <div class="color-card-header">
                    <h3 class="color-card-title">Dark Lavender</h3>
                    <div class="color-swatch color-primary"></div>
                </div>
                <div class="color-card-body">
                    <p><strong>Main:</strong> <span class="color-code">var(--color-primary)</span></p>
                    <p><strong>Hover:</strong> <span class="color-code">var(--color-primary-hover)</span></p>
                    <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-secondary);">Used in dark theme</p>
                </div>
                <div class="color-variant">
                    <div class="color-variant-swatch color-primary-light"></div>
                    <div class="color-variant-info">
                        <div class="color-variant-name">Light Variant</div>
                        <div class="color-variant-code">--color-primary-light</div>
                    </div>
                </div>
                <div class="color-variant">
                    <div class="color-variant-swatch color-primary-dark"></div>
                    <div class="color-variant-info">
                        <div class="color-variant-name">Dark Variant</div>
                        <div class="color-variant-code">--color-primary-dark</div>
                    </div>
                </div>
            </div>

            <!-- Cyan Theme -->
            <div class="color-card">
                <div class="color-card-header">
                    <h3 class="color-card-title">Cyan</h3>
                    <div class="color-swatch color-primary"></div>
                </div>
                <div class="color-card-body">
                    <p><strong>Main:</strong> <span class="color-code">var(--color-primary)</span></p>
                    <p><strong>Hover:</strong> <span class="color-code">var(--color-primary-hover)</span></p>
                    <p style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-secondary);">Used in cyan theme</p>
                </div>
                <div class="color-variant">
                    <div class="color-variant-swatch color-primary-light"></div>
                    <div class="color-variant-info">
                        <div class="color-variant-name">Light Variant</div>
                        <div class="color-variant-code">--color-primary-light</div>
                    </div>
                </div>
                <div class="color-variant">
                    <div class="color-variant-swatch color-primary-dark"></div>
                    <div class="color-variant-info">
                        <div class="color-variant-name">Dark Variant</div>
                        <div class="color-variant-code">--color-primary-dark</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Animated Text Section -->
    <section class="animated-text-section">
        <div class="container">
            <div class="animated-text-label">Animated Color Text</div>
            <div class="animated-text">Beautiful Design</div>
            <p style="color: var(--text-secondary); margin-top: 1rem;">Watch the text color subtly shift through theme shades</p>
        </div>
    </section>

    <!-- Typography Section -->
    <section class="content-section">
        <h2>Typography</h2>
        <h1>Heading 1 - Main Title</h1>
        <h2>Heading 2 - Section Title</h2>
        <h3>Heading 3 - Subsection Title</h3>
        <h4>Heading 4 - Minor Heading</h4>
        <h5>Heading 5 - Small Heading</h5>
        <h6>Heading 6 - Smallest Heading</h6>
        
        <p>This is a paragraph with some sample text. It demonstrates the typography and styling for body text in our design system.</p>
        
        <p>Another paragraph to show spacing and readability. The design is clean, modern, and focuses on excellent user experience.</p>
    </section>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Pass hero tags from Django to JavaScript
const heroTagsData = [
    {% for tag in hero_tags %}
    '{{ tag.title }}'{% if not forloop.last %},{% endif %}
    {% endfor %}
];
</script>
<script src="{% static 'js/hero-animations.js' %}"></script>
<script>
// Polaroid Card Rotation Animation
(function() {
    const polaroidCards = document.querySelectorAll('.polaroid-frame');
    
    if (polaroidCards.length >= 3) {
        // Add rotating class to all cards
        polaroidCards.forEach(card => {
            card.classList.add('rotating');
        });
        
        // Cycle through z-index to create stacking rotation effect
        let currentFront = 0;
        const totalCards = polaroidCards.length;
        let rotationInterval = null;
        let isPaused = false;
        
        function rotateStack() {
            if (isPaused) return;
            
            // Remove previous state classes
            polaroidCards.forEach(card => {
                card.classList.remove('moving-back', 'moving-forward');
            });
            
            // First, apply visual transitions (opacity, blur, scale)
            polaroidCards.forEach((card, index) => {
                const zIndex = (index - currentFront + totalCards) % totalCards;
                const newZIndex = totalCards - zIndex;
                
                // Add transition classes for smooth visual effect
                if (newZIndex === 1) {
                    // Card going to back - fade and blur
                    card.classList.add('moving-back');
                } else if (newZIndex === totalCards) {
                    // Card coming to front - brighten and focus
                    card.classList.add('moving-forward');
                }
            });
            
            // Then update z-index after a longer delay to allow smooth visual transition
            setTimeout(() => {
                polaroidCards.forEach((card, index) => {
                    const zIndex = (index - currentFront + totalCards) % totalCards;
                    const newZIndex = totalCards - zIndex;
                    card.style.zIndex = newZIndex.toString();
                    // Also update z-index on parent link if it exists
                    const link = card.closest('.polaroid-link');
                    if (link) {
                        link.style.zIndex = newZIndex.toString();
                    }
                });
                
                // Remove transition classes after z-index change to allow normal animation
                setTimeout(() => {
                    polaroidCards.forEach(card => {
                        card.classList.remove('moving-back', 'moving-forward');
                    });
                }, 500);
            }, 800);
            
            // Move to next card
            currentFront = (currentFront + 1) % totalCards;
        }
        
        function startRotation() {
            if (rotationInterval) clearInterval(rotationInterval);
            isPaused = false;
            rotateStack();
            rotationInterval = setInterval(rotateStack, 7000);
        }
        
        function stopRotation() {
            if (rotationInterval) {
                clearInterval(rotationInterval);
                rotationInterval = null;
            }
            isPaused = true;
        }
        
        // Start rotation
        startRotation();
        
        // Handle hover - bring card to front
        polaroidCards.forEach((card, index) => {
            card.addEventListener('mouseenter', function() {
                // Pause rotation
                stopRotation();
                // Pause all animations
                polaroidCards.forEach(c => {
                    c.style.animationPlayState = 'paused';
                });
                // Bring hovered card to front
                this.style.zIndex = '10';
                const link = this.closest('.polaroid-link');
                if (link) {
                    link.style.zIndex = '10';
                }
            });
            
            card.addEventListener('mouseleave', function() {
                // Remove transition classes
                polaroidCards.forEach(c => {
                    c.classList.remove('moving-back', 'moving-forward');
                });
                // Resume animations
                polaroidCards.forEach(c => {
                    c.style.animationPlayState = 'running';
                });
                // Resume rotation
                startRotation();
            });
        });
    }
})();
</script>
{% endblock %}
