{% extends 'base.html' %}
{% load static %}
{% load academics_filters %}
{% load user_filters %}

{% block title %}Home{% endblock %}

{% block extra_css %}
<style>
/* Critical CSS for above-the-fold content - prevents layout shift */
.home-hero {
    min-height: 80vh;
    padding: 2rem 0 4rem;
    background: linear-gradient(180deg,
        var(--bg-primary) 0%,
        color-mix(in srgb, var(--color-primary) 8%, var(--bg-primary)) 50%,
        var(--bg-primary) 100%);
    position: relative;
    overflow: hidden;
}

.hero-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
    display: flex;
    align-items: flex-start;
    gap: 4rem;
}

.hero-content {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: flex-start;
    gap: 4rem;
    width: 100%;
}

.hero-text {
    flex: 1;
    max-width: 600px;
}

.hero-welcome {
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 400;
    color: var(--text-secondary);
    margin-bottom: 0.25rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
}

.hero-title {
    font-size: clamp(3.5rem, 10vw, 7rem);
    font-weight: 800;
    background: linear-gradient(135deg, var(--color-primary) 0%, #764ba2 50%, #f093fb 100%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1;
    margin-bottom: 1.5rem;
}

.hero-visuals {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
}

/* UAP Now Section Critical CSS */
.uapnow-section {
    padding: 3rem 0 2rem;
    background: linear-gradient(180deg,
        transparent 0%,
        color-mix(in srgb, var(--color-primary) 6%, transparent) 50%,
        transparent 100%);
}

.uapnow-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
}

.uapnow-card {
    min-height: 280px;
    background: var(--bg-secondary);
    border-radius: 16px;
    padding: 1.15rem;
}

/* Mobile critical styles */
@media (max-width: 768px) {
    .hero-content {
        flex-direction: column;
        gap: 2rem;
    }
    
    .hero-title {
        font-size: clamp(2.5rem, 12vw, 4rem);
    }
    
    .home-hero {
        min-height: auto;
        padding: 1.5rem 0 2rem;
    }
}
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="home-hero">
    <div class="hero-container">
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-welcome">Welcome to</h1>
                <h1 class="hero-title">UAP-CSE</h1>
                <div class="hero-tagline">Committed to Excellence in Computer Science Education Since 1996 ‚ú¶ </div>
                <div class="hero-stats">
                    <!-- <span class="stats-prefix">We have</span> -->
                    <span class="stats-dynamic" id="dynamicStats">
                        {% if hero_tags.first %}
                            {{ hero_tags.first.title }}
                        {% else %}
                            Loading...
                        {% endif %}
                    </span>
                </div>
            </div>
            <div class="hero-visuals">
                <div class="polaroid-container">
                    {% for card in feature_cards %}
                    <a href="{% url 'designs:feature_card_detail' card.pk %}" class="polaroid-link">
    <div class="polaroid-frame polaroid-{{ forloop.counter }}">
                            <div class="polaroid-image">
                                {% if card.picture %}
                                    <img src="/media/{{ card.picture.name }}" alt="{{ card.title }}">
                                {% endif %}
                            </div>
                            <div class="polaroid-caption">{{ card.caption }}</div>
                        </div>
                    </a>
                    {% empty %}
                    <!-- Fallback if no feature cards -->
                    <div class="polaroid-frame polaroid-1">
                        <div class="polaroid-image"></div>
                        <div class="polaroid-caption">Student Life</div>
                    </div>
                    <div class="polaroid-frame polaroid-2">
                        <div class="polaroid-image"></div>
                        <div class="polaroid-caption">Innovation</div>
                    </div>
                    <div class="polaroid-frame polaroid-3">
                        <div class="polaroid-image"></div>
                        <div class="polaroid-caption">Community</div>
                    </div>
                    {% endfor %}
                </div>
                <div class="hero-greeting">
                    <!-- <br> -->
                    <!-- <span class="brief-text" id="briefText">Whats up?</span> -->
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Marks Distribution Network Banner -->
<section class="marks-network-banner-wrapper">
    <div class="container marks-network-container">
        <div class="marks-network-banner" id="marks-banner">
            <!-- Animated Background -->
            <div class="marks-network-bg-animated">
                <div class="color-shift-layer"></div>
            </div>
            <!-- Content -->
            <div class="marks-network-content">
                <div class="marks-network-text">
                    <p class="marks-network-tagline">First University in Bangladesh: Publicly Available Network Showing Detailed Calculation of Every Mark Across Your 4-Year B.Sc. in CSE Journey</p>
                </div>
                <div class="marks-network-hint">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
            </div>
        </div>
    </div>
</section>



<!-- UAP Now Section -->
<section class="uapnow-section">
    <div class="container uapnow-container">
        <div class="uapnow-header">
            <div>
                <p class="eyebrow uapnow-anim">Whats up?</p><br>
                <h2 class="uapnow-anim uapnow-title">UAP CSE Now <span class="uapnow-star" aria-hidden="true">‚ú¶Àñ</span></h2>
                <p class="subtitle">Everything at a glance ‚Äî notices, events, seminars, workshops.</p>
                <a href="{% url 'office:post_list' %}" class="view-all-link">View All Posts ‚Üí</a>
            </div>
            <div class="uapnow-filters">
                <button class="uapnow-chip active" type="button">Notices</button>
                <button class="uapnow-chip" type="button">Events</button>
                <button class="uapnow-chip" type="button">Seminars</button>
                <button class="uapnow-chip" type="button">Workshops</button>
            </div>
        </div>
        <div class="uapnow-grid" id="uapnowGrid">
            {% if uap_now_posts %}
                {% for post_item in uap_now_posts %}
                {% if post_item.type == 'post' %}
                    {% with post=post_item.object %}
                    <div class="uapnow-card {% if post.is_pinned %}uapnow-pinned{% endif %} {% if post.thumbnail %}uapnow-card-with-thumbnail{% endif %}" 
                         data-pinned="{% if post.is_pinned %}true{% else %}false{% endif %}"
                         data-post-type="post"
                         data-post-id="{{ post.pk }}"
                         onclick="openUapNowModal('post', {{ post.pk }})" 
                         style="cursor: pointer;{% if post.thumbnail %}background-image: url('{{ post.thumbnail.url }}');{% endif %}">
                        {% if post.thumbnail %}
                        <div class="uapnow-card-overlay">
                            <div class="uapnow-card-info">
                                <h3 class="uapnow-card-title">{{ post.short_title }}</h3>
                                <p class="uapnow-card-description">{{ post.long_title|truncatewords:8 }}</p>
                            </div>
                        </div>
                        {% else %}
                        <div class="uapnow-top">
                            <div class="uapnow-badge uapnow-badge-{{ post.post_type }}{% if post.is_pinned %} pinned{% endif %}">
                                {% if post.is_pinned %}
                                <span class="pin-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 17v5M9 10V6a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3v4M5 10h14l-1 7H6l-1-7z"></path>
                                    </svg>
                                </span>
                                {% endif %}
                                {{ post.get_post_type_display }}
                            </div>
                            <div class="uapnow-date">{{ post.publish_date|date:"M d, Y" }}</div>
                        </div>
                        <h3>{{ post.short_title }}</h3>
                        <p>{{ post.long_title|truncatewords:15 }}</p>
                        {% if post.tags %}
                        <div class="uapnow-tags">
                            {% for tag in post.get_tags_list|slice:":3" %}
                            <span class="tag soft">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        {% endif %}
                    </div>
                    {% endwith %}
                {% else %}
                    {% with club_post=post_item.object %}
                    <div class="uapnow-card" 
                         data-pinned="false"
                         data-post-type="club_post"
                         data-post-id="{{ club_post.pk }}"
                         onclick="openUapNowModal('club_post', {{ club_post.pk }})" 
                         style="cursor: pointer;">
                        <div class="uapnow-top">
                            <div class="uapnow-badge uapnow-badge-{{ club_post.post_type }}{% if club_post.is_pinned %} pinned{% endif %}">
                                {% if club_post.is_pinned %}
                                <span class="pin-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M12 17v5M9 10V6a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3v4M5 10h14l-1 7H6l-1-7z"></path>
                                    </svg>
                                </span>
                                {% endif %}
                                {{ club_post.get_post_type_display }}
                            </div>
                            <div class="uapnow-date">{{ club_post.created_at|date:"M d, Y" }}</div>
                        </div>
                        {% if club_post.club.short_name %}
                        <div class="uapnow-club-badge">
                            <a href="{% url 'clubs:club_detail' club_post.club.pk %}" class="club-link" onclick="event.stopPropagation();">{{ club_post.club.short_name }}</a>
                        </div>
                        {% endif %}
                        <h3>{{ club_post.short_title }}</h3>
                        <p>{{ club_post.long_title|truncatewords:15 }}</p>
                        {% if club_post.tags %}
                        <div class="uapnow-tags">
                            {% for tag in club_post.get_tags_list|slice:":3" %}
                            <span class="tag soft">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                    {% endwith %}
                {% endif %}
                {% endfor %}
            {% else %}
                <!-- Fallback if no posts available -->
                <div class="uapnow-card">
                    <div class="uapnow-top">
                        <div class="uapnow-badge">Notice</div>
                        <div class="uapnow-date">No posts</div>
                    </div>
                    <h3>No posts available</h3>
                    <p>Check back later for updates.</p>
                </div>
            {% endif %}
        </div>
        
        <!-- Carousel Controls -->
        <div class="uapnow-carousel-controls" id="uapnowCarouselControls">
            <button class="uapnow-carousel-btn" id="uapnowPrev" title="Previous post">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>
            <div class="uapnow-carousel-indicator" id="uapnowIndicator">
                <!-- Dots will be generated by JS -->
            </div>
            <button class="uapnow-carousel-btn" id="uapnowNext" title="Next post">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </button>
            <div class="uapnow-carousel-status">
                <span id="uapnowStatus">Auto-rotating</span>
                <svg class="pause-icon" id="uapnowPauseBtn" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" title="Pause/Resume">
                    <rect x="6" y="4" width="4" height="16"></rect>
                    <rect x="14" y="4" width="4" height="16"></rect>
                </svg>
            </div>
        </div>
    </div>
</section>

<!-- Post Modal for UAP Now -->
<div id="uapNowModal" class="post-modal">
    <div class="post-modal-content" id="uapNowModalContent">
        <div class="post-modal-header">
            <h2 class="post-modal-title">Post Details</h2>
            <div class="post-modal-actions">
                <button class="post-modal-action-btn" onclick="openUapNowPostDetail()" title="Open in new page" id="uapNowModalOpenBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                        <polyline points="15 3 21 3 21 9"></polyline>
                        <line x1="10" y1="14" x2="21" y2="3"></line>
                    </svg>
                    <span>Open</span>
                </button>
                <button class="post-modal-action-btn" onclick="copyUapNowPostLink()" title="Copy link" id="uapNowModalCopyBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                    </svg>
                    <span>Copy Link</span>
                </button>
            <button class="post-modal-close" onclick="closeUapNowModal()" title="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
            </div>
        </div>
        <div class="post-modal-body">
            <div class="post-modal-thumbnail-container" id="uapNowModalThumbnail" style="display: none;">
                <img src="" alt="" class="post-modal-thumbnail" id="uapNowModalThumbnailImg">
            </div>
            <div class="post-modal-meta">
                <span class="post-modal-badge" id="uapNowModalBadge">Event</span>
                <span class="post-modal-date" id="uapNowModalDate">Dec 11, 2025</span>
            </div>
            <h1 class="post-modal-full-title" id="uapNowModalFullTitle">Post Title</h1>
            <div class="post-modal-tags" id="uapNowModalTags"></div>
            <div class="post-modal-description" id="uapNowModalDescription"></div>
        </div>
    </div>
</div>

<!-- Easy Access Section -->
<section class="easy-access-section">
    <div class="container easy-access-container">
        <div class="easy-access-header">
            <p class="eyebrow">Quick Links</p>
            <h2>Easy Access</h2>
            <p class="subtitle">Quick access to important pages and resources.</p>
        </div>
        <div class="easy-access-grid">
            <a href="{% url 'designs:feature_cards_list' %}" class="easy-access-tile">
                <div class="tile-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                </div>
                <h3>Why CSE?</h3>
            </a>
            <a href="{% url 'academics:courses_list' %}" class="easy-access-tile">
                <div class="tile-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 19.5A2.5 2.5 0 0 0 6.5 22h11a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 17.5 2h-11A2.5 2.5 0 0 0 4 4.5Z"></path>
                        <path d="M8 10h8"></path>
                        <path d="M8 14h6"></path>
                        <path d="M8 6h8"></path>
                    </svg>
                </div>
                <h3>Courses</h3>
            </a>
            <a href="{% url 'office:routine_list' %}" class="easy-access-tile">
                <div class="tile-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                        <path d="M8 14h.01"></path>
                        <path d="M12 14h.01"></path>
                        <path d="M16 14h.01"></path>
                        <path d="M8 18h.01"></path>
                        <path d="M12 18h.01"></path>
                        <path d="M16 18h.01"></path>
                    </svg>
                </div>
                <h3>Routine</h3>
            </a>
            <a href="{% url 'people:faculty_list' %}" class="easy-access-tile">
                <div class="tile-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                </div>
                <h3>Faculties</h3>
            </a>
            <a href="{% url 'designs:admission_element_detail' 3 %}" class="easy-access-tile">
                <div class="tile-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 11H1l9-9 9 9h-8z"></path>
                        <path d="M9 11v10a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2V11"></path>
                    </svg>
                </div>
                <h3>Waivers</h3>
            </a>
            <a href="{% url 'clubs:activities' %}" class="easy-access-tile">
                <div class="tile-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 6v6l4 2"></path>
                    </svg>
                </div>
                <h3>Activities</h3>
            </a>
        </div>
    </div>
</section>

<!-- Research and Publications Section -->
{% if research_stats %}
<section class="research-home-section">
    <div class="container research-home-container">
        <div class="research-home-header">
            <p class="eyebrow">Research & Publications</p>
            <h2>Departmental Research</h2>
            <p class="subtitle">Our faculty's research contributions and publications.</p>
            <a href="{% url 'people:departmental_research' %}" class="view-all-link">View Full Research Page ‚Üí</a>
        </div>
        
        <!-- Stats with Pie Chart Layout -->
        <div class="research-stats-with-chart">
            <!-- Pie Chart on Left -->
            <div class="pie-chart-wrapper-home">
                <div class="chart-card-home">
                    <div class="chart-header-home">
                        <h3 class="chart-title-home">Publications by Type</h3>
                    </div>
                    <div class="chart-wrapper-home">
                        <canvas id="typeChartHome"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Stats Cards on Right -->
            <div class="stats-cards-wrapper-home">
                <!-- First Row: Total Citations, Total Papers -->
                <div class="stats-row-top-home">
                    <div class="research-stat-item stat-large-home stat-citations-home">
                        <div class="stat-icon">üìà</div>
                        <div class="research-stat-value" data-target="{{ research_stats.total_citations|floatformat:0 }}" data-is-decimal="false">0</div>
                        <div class="research-stat-label">Total Citations</div>
                    </div>
                    <div class="research-stat-item stat-large-home stat-publications-home">
                        <div class="stat-icon">üìä</div>
                        <div class="research-stat-value" data-target="{{ research_stats.total_pubs }}" data-is-decimal="false">0</div>
                        <div class="research-stat-label">Total Publications</div>
                    </div>
                </div>
                
                <!-- Second Row: Other 3 Stats -->
                <div class="stats-row-bottom-home">
                    <div class="research-stat-item stat-compact-home">
                        <div class="stat-icon">üìÑ</div>
                        <div class="research-stat-value" data-target="{{ research_stats.avg_pubs_per_faculty }}" data-is-decimal="true" data-decimal-places="2">0</div>
                        <div class="research-stat-label">Avg Papers per Faculty</div>
                    </div>
                    <div class="research-stat-item stat-compact-home">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="research-stat-value" data-target="{{ research_stats.avg_citations_per_faculty }}" data-is-decimal="true" data-decimal-places="2">0</div>
                        <div class="research-stat-label">Avg Citations per Faculty</div>
                    </div>
                    <div class="research-stat-item stat-compact-home">
                        <div class="stat-icon">üë•</div>
                        <div class="research-stat-value" data-target="{{ research_stats.num_faculty }}" data-is-decimal="false">0</div>
                        <div class="research-stat-label">Contributing Faculty</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Top Researchers with Tabs -->
        <div class="top-researchers-home">
            <div class="top-researchers-header">
                <h3 class="top-researchers-title">Top Researchers</h3>
                <button class="info-btn-home" id="top-researchers-info-btn" title="How are top researchers selected?">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                </button>
            </div>
            
            <!-- Tabs -->
            <div class="researchers-tabs-home">
                <button class="researcher-tab-btn-home active" data-tab="most-cited">
                    Most Cited
                    <button class="tab-info-btn-home" id="most-cited-info-btn" title="How are most cited researchers selected?" onclick="event.stopPropagation(); openTabInfoModal('most-cited')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </button>
                </button>
                <button class="researcher-tab-btn-home" data-tab="leading-active">
                    Leading Active
                    <button class="tab-info-btn-home" id="leading-active-info-btn" title="How are leading active researchers selected?" onclick="event.stopPropagation(); openTabInfoModal('leading-active')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </button>
                </button>
                <button class="researcher-tab-btn-home" data-tab="top-designation">
                    Top by Designation
                    <button class="tab-info-btn-home" id="top-designation-info-btn" title="How are top researchers by designation selected?" onclick="event.stopPropagation(); openTabInfoModal('top-designation')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                            <line x1="12" y1="17" x2="12.01" y2="17"></line>
                        </svg>
                    </button>
                </button>
            </div>
            
            <!-- Tab Content: Most Cited -->
            <div class="researcher-tab-content-home active" id="most-cited-tab">
                <div class="top-researchers-grid-home">
                    {% if most_cited_researchers %}
                        {% for item in most_cited_researchers %}
                        <a href="{% url 'people:faculty_detail' item.faculty.pk %}" class="top-researcher-card-home">
                            <div class="researcher-card-home-image">
                                <img src="{% if item.faculty.profile_pic %}/media/{{ item.faculty.profile_pic.name }}{% else %}{% static 'defaults/people.png' %}{% endif %}" alt="{{ item.faculty.name }}">
                                <div class="researcher-card-home-overlay">
                                    <div class="researcher-card-home-info">
                                        <h3 class="researcher-name-home">{{ item.faculty.name }}</h3>
                                        <div class="researcher-citation-home">Cited by: {{ item.citations|floatformat:0 }}</div>
                                    </div>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    {% else %}
                        <p class="empty-message-home">No researchers found.</p>
                    {% endif %}
                </div>
            </div>
            
            <!-- Tab Content: Leading Active -->
            <div class="researcher-tab-content-home" id="leading-active-tab">
                <div class="top-researchers-grid-home">
                    {% if leading_active_researchers %}
                        {% for item in leading_active_researchers %}
                        <a href="{% url 'people:faculty_detail' item.faculty.pk %}" class="top-researcher-card-home">
                            <div class="researcher-card-home-image">
                                <img src="{% if item.faculty.profile_pic %}/media/{{ item.faculty.profile_pic.name }}{% else %}{% static 'defaults/people.png' %}{% endif %}" alt="{{ item.faculty.name }}">
                                <div class="researcher-card-home-overlay">
                                    <div class="researcher-card-home-info">
                                        <h3 class="researcher-name-home">{{ item.faculty.name }}</h3>
                                        <div class="researcher-meta-home">
                                            <div class="researcher-score-home">Score: {{ item.score }}</div>
                                            <div class="researcher-pubs-home">Pubs (2yr): {{ item.publication_count }}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    {% else %}
                        <p class="empty-message-home">No researchers found.</p>
                    {% endif %}
                </div>
            </div>
            
            <!-- Tab Content: Top by Designation -->
            <div class="researcher-tab-content-home" id="top-designation-tab">
                <div class="top-researchers-grid-home">
                    {% if top_researchers %}
                        {% for designation in top_researchers.keys %}
                            {% with researcher=top_researchers|get_item:designation %}
                            <a href="{% url 'people:faculty_detail' researcher.faculty.pk %}" class="top-researcher-card-home">
                                <div class="researcher-card-home-image">
                                    <img src="{% if researcher.faculty.profile_pic %}/media/{{ researcher.faculty.profile_pic.name }}{% else %}{% static 'defaults/people.png' %}{% endif %}" alt="{{ researcher.faculty.name }}">
                                    <div class="researcher-card-home-overlay">
                                        <div class="researcher-card-home-info">
                                            <h3 class="researcher-name-home">{{ researcher.faculty.name }}</h3>
                                            <div class="researcher-meta-home">
                                                <div class="researcher-citation-home">Cited by: {{ researcher.citations|floatformat:0 }}</div>
                                                <div class="researcher-score-home">Score: {{ researcher.score }}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="researcher-designation-home">{{ designation }}</div>
                            </a>
                            {% endwith %}
                        {% endfor %}
                    {% else %}
                        <p class="empty-message-home">No researchers found.</p>
                    {% endif %}
                </div>
            </div>
            
            <!-- Browse More Faculties Button -->
            <div class="browse-faculties-wrapper">
                <a href="{% url 'people:departmental_research' %}?tab=faculty" class="browse-faculties-btn">
                    Browse More Faculties ‚Üí
                </a>
            </div>
        </div>
    </div>
    
    <!-- Info Modal for Top Researchers -->
    <div class="info-modal-home" id="top-researchers-info-modal">
        <div class="info-modal-content-home">
            <div class="info-modal-header-home">
                <h3>How Top Researchers are Selected</h3>
                <button class="info-modal-close-home" id="close-top-researchers-info-modal">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="info-modal-body-home">
                <p>The top researchers are selected based on their research scores, calculated from their publications:</p>
                <ul>
                    <li><strong>Q1 publications:</strong> 10 points each</li>
                    <li><strong>Q2 publications:</strong> 7 points each</li>
                    <li><strong>Q3 publications:</strong> 5 points each</li>
                    <li><strong>Q4 publications:</strong> 3 points each</li>
                    <li><strong>A* publications:</strong> 8 points each</li>
                    <li><strong>A publications:</strong> 6 points each</li>
                    <li><strong>B publications:</strong> 4 points each</li>
                    <li><strong>C publications:</strong> 2 points each</li>
                    <li><strong>Not Indexed:</strong> 1 point each</li>
                </ul>
                <p>For each designation (Professor, Associate Professor, Assistant Professor, Lecturer), the faculty member with the highest research score is featured. In case of a tie, the researcher with publications spanning fewer years (more concentrated research) is selected.</p>
            </div>
        </div>
    </div>
<!-- Most Cited Info Modal -->
<div class="info-modal-home" id="most-cited-info-modal">
    <div class="info-modal-content-home">
        <div class="info-modal-header-home">
            <h3>Most Cited Researchers</h3>
            <button class="info-modal-close-home" onclick="closeTabInfoModal('most-cited')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="info-modal-body-home">
            <p>Most Cited researchers are selected based on the total number of citations they have received across their publications.</p>
        </div>
    </div>
</div>

<!-- Leading Active Info Modal -->
<div class="info-modal-home" id="leading-active-info-modal">
    <div class="info-modal-content-home">
        <div class="info-modal-header-home">
            <h3>Leading Active Researchers</h3>
            <button class="info-modal-close-home" onclick="closeTabInfoModal('leading-active')">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="info-modal-body-home">
            <p>Leading Active researchers are selected based on their research activity in the last 2 years, including the number of publications and research score.</p>
        </div>
    </div>
</div>
<div class="info-modal-home" id="top-designation-info-modal">
    <div class="info-modal-content-home">
        <div class="info-modal-header-home">
            <h3>Top Researchers by Designation</h3>
            <button class="info-modal-close-home" onclick="closeTabInfoModal('top-designation')">&times;</button>
        </div>
        <div class="info-modal-body-home">
            <p>Top researchers by designation are selected based on their highest citation count within each faculty title (Professor, Associate Professor, etc.).</p>
        </div>
    </div>
</div>

</section>
{% endif %}

<!-- Head Message Section -->
<section class="hod-section">
    <div class="container hod-container">
        <div class="hod-card" onclick="openHodModal()" style="cursor: pointer;">
            <div class="hod-title-row">
                <div>
                    <p class="eyebrow">Message from</p>
                    <h2>Head of the Department</h2>
                </div>
                <div class="hod-pill">Inspiring Leadership</div>
            </div>
            <div class="hod-content">
                <div class="hod-profile">
                    <div class="hod-avatar">
                        {% if hod_card and hod_card.picture %}
                            <img src="/media/{{ hod_card.picture.name }}" alt="{{ hod_card.title }}" loading="lazy">
                        {% else %}
                            <img src="{% static 'images/hod.jpg' %}" alt="Head of Department" loading="lazy">
                        {% endif %}
                    </div>
                    <div class="hod-meta">
                        <h3>{% if hod_card %}{{ hod_card.caption }}{% else %}Dr. Shah Murtaza Rashid Al Masud{% endif %}</h3>
                        <p>{% if hod_card %}{{ hod_card.title }}{% else %}Head of the Department{% endif %}</p>
                    </div>
                </div>
                <div class="hod-message">
                    <div class="hod-quote-mark">"</div>
                    <p>
                        {% if hod_card %}
                            {{ hod_card.description|safe|truncatewords:60 }}
                        {% else %}
                            Hello to the Department of Computer Science and Engineering (CSE) at University of Asia Pacific (UAP),
                            Bangladesh. Computer Science is an exciting, challenging and dynamic discipline which is now widely
                            recognized as an essential source of tools and techniques for advancements in nearly all spheres of life.
                        {% endif %}
                    </p>
                    <p class="hod-read-more">‚Ä¶ <span style="color: var(--color-primary); font-weight: 700;">Click to read full message</span></p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Head Message Modal -->
<div id="hodModal" class="hod-modal">
    <div class="hod-modal-content">
        <div class="hod-modal-header">
            <div class="hod-modal-title-section">
                <p class="eyebrow">Message from</p>
                <h2>Head of the Department</h2>
            </div>
            <button class="hod-modal-close" onclick="closeHodModal()" title="Close">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="hod-modal-body">
            <div class="hod-modal-profile">
                <div class="hod-modal-avatar">
                    {% if hod_card and hod_card.picture %}
                        <img src="/media/{{ hod_card.picture.name }}" alt="{{ hod_card.title }}" loading="lazy">
                    {% else %}
                        <img src="{% static 'images/hod.jpg' %}" alt="Head of Department" loading="lazy">
                    {% endif %}
                </div>
                <div class="hod-modal-meta">
                    <h3>{% if hod_card %}{{ hod_card.title }}{% else %}Dr. Shah Murtaza Rashid Al Masud{% endif %}</h3>
                    <p>{% if hod_card %}{{ hod_card.caption }}{% else %}Head of the Department{% endif %}</p>
                </div>
            </div>
            <div class="hod-modal-message">
                <div class="hod-modal-quote-mark">"</div>
                <div class="hod-modal-text">
                    {% if hod_card %}
                        {{ hod_card.description|safe }}
                    {% else %}
                        <p>Hello to the Department of Computer Science and Engineering (CSE) at University of Asia Pacific (UAP), Bangladesh. Computer Science is an exciting, challenging and dynamic discipline which is now widely recognized as an essential source of tools and techniques for advancements in nearly all spheres of life.</p>
                        <p>Our department is committed to providing quality education, fostering innovation, and preparing students for successful careers in the ever-evolving field of computer science and engineering. We strive to create an environment that encourages critical thinking, creativity, and collaboration.</p>
                        <p>Through our comprehensive curriculum, state-of-the-art facilities, and dedicated faculty, we aim to equip our students with the knowledge and skills necessary to excel in their chosen fields and contribute meaningfully to society.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Gallery Showcase Section -->
{% if gallery_items %}
<section class="gallery-showcase-section">
    <div class="container gallery-showcase-container">
        <div class="gallery-showcase-header">
            <div>
                <p class="eyebrow">Gallery</p>
                <h2>Moments & Memories</h2>
                <p class="subtitle">Capturing the spirit of CSE, UAP</p>
            </div>
        </div>
        
        <div class="gallery-stack-wrapper">
            <button class="gallery-nav-btn gallery-nav-left" type="button" onclick="prevGallerySlide()" aria-label="Previous image">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
            </button>
            <div class="gallery-stack" id="galleryStack">
                {% for item in gallery_items %}
                <div class="gallery-stack-card" data-index="{{ forloop.counter0 }}" onclick="openGalleryModal({{ forloop.counter0 }})">
                    <div class="gallery-stack-card-inner">
                        <img src="{{ item.image.url }}" alt="{{ item.short_title }}" loading="lazy">
                        <div class="gallery-stack-card-overlay">
                            <h3>{{ item.short_title }}</h3>
                            {% if item.description %}
                            <p>{{ item.description }}</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <button class="gallery-nav-btn gallery-nav-right" type="button" onclick="nextGallerySlide()" aria-label="Next image">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
            </button>
            <!-- Dots Navigation -->
            <div class="gallery-dots" id="galleryDots">
                {% for item in gallery_items %}
                <button class="gallery-dot {% if forloop.first %}active{% endif %}" data-index="{{ forloop.counter0 }}" onclick="goToGallerySlide({{ forloop.counter0 }})" aria-label="Go to slide {{ forloop.counter }}"></button>
                {% endfor %}
            </div>
        </div>
        
        <div class="gallery-showcase-footer">
            <a href="{% url 'office:gallery' %}" class="gallery-browse-all-btn">
                Browse All
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                    <polyline points="12 5 19 12 12 19"></polyline>
                </svg>
            </a>
        </div>
    </div>
</section>

<!-- Gallery Modal -->
<div id="galleryModal" class="gallery-modal">
    <div class="gallery-modal-content">
        <button class="gallery-modal-close" onclick="closeGalleryModal()" title="Close">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        <div class="gallery-modal-body" id="galleryModalBody">
            <!-- Content will be dynamically inserted -->
        </div>
    </div>
</div>
{% endif %}

<!-- Mission Vision PEO Section -->
<section class="mvpeo-section">
    <div class="container mvpeo-container">
        <div class="mvpeo-header">
            <div>
                <p class="eyebrow">Who We Are</p>
                <h2>Vision, Mission & PEOs</h2>
                <p class="subtitle">A concise snapshot of what drives CSE, UAP ‚Äî right below the hero.</p>
            </div>
            <div class="mvpeo-badges">
                <span class="badge soft"><span class="badge-label">Outcome Based Education</span></span>
                <span class="badge soft"><span class="badge-label">Reserach & Innovation</span></span>
                <span class="badge soft"><span class="badge-label">Sustainable Impact</span></span>
            </div>
        </div>

        <div class="mvpeo-grid vision-grid">
            <div class="mvpeo-title-row">
                <div class="pill neutral">Vision</div>
                <p class="section-hint">Our north star distilled into three focus areas.</p>
            </div>
            <div class="card-grid three">
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M2 12h20"></path>
                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        </svg>
                    </div>
                    <h3>Global Graduates</h3>
                    <p>Prepare graduates as global leaders with quality education and research excellence.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M9 18h6"></path>
                            <path d="M10 22h4"></path>
                            <path d="M12 2C8 2 5 5 5 9c0 5 7 11 7 11s7-6 7-11c0-4-3-7-7-7Z"></path>
                            <circle cx="12" cy="9" r="2"></circle>
                        </svg>
                    </div>
                    <h3>Innovation & Growth</h3>
                    <p>Foster innovative ideas, extracurricular exploration, and continuous development.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M7 8h10"></path>
                            <path d="M7 12h10"></path>
                            <path d="M7 16h10"></path>
                            <path d="M3 8h1"></path>
                            <path d="M3 12h1"></path>
                            <path d="M3 16h1"></path>
                            <path d="M20 8h1"></path>
                            <path d="M20 12h1"></path>
                            <path d="M20 16h1"></path>
                            <rect x="4" y="4" width="16" height="16" rx="2"></rect>
                        </svg>
                    </div>
                    <h3>Industry Collaboration</h3>
                    <p>Bridge industry and academia to pioneer ICT leadership for Bangladesh and beyond.</p>
                </div>
            </div>
        </div>

        <div class="mvpeo-grid mission-grid">
            <div class="mvpeo-title-row">
                <div class="pill neutral">Mission</div>
                <p class="section-hint">Four missions ‚Äî each a promise to our students and community.</p>
            </div>
            <div class="card-grid four">
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="m10 10 4-2-2 4-4 2 2-4Z"></path>
                        </svg>
                    </div>
                    <h3>Mission 1</h3>
                    <p>Equip students with strong CS theory, engineering principles, and practical skills for diverse careers and advanced studies.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 4h7"></path>
                            <path d="M9 20h7"></path>
                            <path d="M5 4 19 20"></path>
                            <path d="M19 4 5 20"></path>
                        </svg>
                    </div>
                    <h3>Mission 2</h3>
                    <p>Enable lifelong learning and professional growth by embracing technological advancements and cutting-edge research.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 22V2"></path>
                            <path d="M5 9h14"></path>
                            <path d="M5 15h14"></path>
                        </svg>
                    </div>
                    <h3>Mission 3</h3>
                    <p>Cultivate an entrepreneurial mindset, foster innovation, and empower individuals to build sustainable solutions.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M7 7h10v5H7z"></path>
                            <path d="M5 11h14"></path>
                            <path d="M12 7v5"></path>
                            <path d="M5 16h14"></path>
                            <path d="M8 16v1"></path>
                            <path d="M16 16v1"></path>
                        </svg>
                    </div>
                    <h3>Mission 4</h3>
                    <p>Promote ethics, social responsibility, and community service, emphasizing responsible technology for society‚Äôs benefit.</p>
                </div>
            </div>
        </div>

        <div class="mvpeo-grid peo-grid">
            <div class="mvpeo-title-row">
                <div class="pill neutral">PEOs</div>
                <p class="section-hint">Program Educational Objectives that shape our graduates.</p>
            </div>
            <div class="card-grid four">
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <circle cx="12" cy="12" r="4"></circle>
                            <path d="m15 9-6 6"></path>
                        </svg>
                    </div>
                    <h3>PEO 1</h3>
                    <p>Pursue successful careers in software development, IT consulting, R&D, entrepreneurship, or advanced studies.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10.325 4.317 9.257 2.9A1 1 0 0 0 8.45 2.5H5.5a1 1 0 0 0-1 1V5"></path>
                            <path d="M18.5 8V5a1 1 0 0 0-1-1h-3"></path>
                            <path d="m20.6 13.5-.9-.3"></path>
                            <path d="m3.4 13.5.9-.3"></path>
                            <path d="m6 20 1.5-3"></path>
                            <path d="m18 20-1.5-3"></path>
                            <path d="M12 12V9"></path>
                            <path d="M12 12 9.6 8"></path>
                            <path d="M12 12h3.4"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </div>
                    <h3>PEO 2</h3>
                    <p>Apply deep engineering knowledge and skills to solve complex, real-world problems.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M4 19.5A2.5 2.5 0 0 0 6.5 22h11a2.5 2.5 0 0 0 2.5-2.5v-15A2.5 2.5 0 0 0 17.5 2h-11A2.5 2.5 0 0 0 4 4.5z"></path>
                            <path d="M8 10h8"></path>
                            <path d="M8 14h6"></path>
                            <path d="M8 6h8"></path>
                        </svg>
                    </div>
                    <h3>PEO 3</h3>
                    <p>Engage in lifelong learning and professional development by adapting to technological advancements.</p>
                </div>
                <div class="info-card">
                    <div class="card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 21s-6-4.35-6-10a6 6 0 1 1 12 0c0 5.65-6 10-6 10Z"></path>
                            <circle cx="12" cy="11" r="2"></circle>
                        </svg>
                    </div>
                    <h3>PEO 4</h3>
                    <p>Contribute to society with engineering knowledge, skills, and ethical values.</p>
                </div>
            </div>
        </div>

        <div class="mvpeo-grid mapping-grid">
            <div class="mvpeo-title-row">
                <div class="pill outline">Mission ‚Üî PEO Mapping</div>
                <p class="section-hint">See how each mission underpins our PEOs.</p>
            </div>
            <div class="mapping-card">
                <div class="mapping-legend">
                    <span class="legend-dot primary"></span>Strong alignment
                    <span class="legend-dot soft"></span>Supportive alignment
                </div>
                <div class="mapping-table">
                    <div class="mapping-row mapping-head">
                        <div class="cell head">Mission / PEO</div>
                        <div class="cell head">PEO 1</div>
                        <div class="cell head">PEO 2</div>
                        <div class="cell head">PEO 3</div>
                        <div class="cell head">PEO 4</div>
                    </div>
                    <div class="mapping-row">
                        <div class="cell label">Mission 1</div>
                        <div class="cell mark strong">‚úì</div>
                        <div class="cell mark soft"></div>
                        <div class="cell mark soft"></div>
                        <div class="cell mark"></div>
                    </div>
                    <div class="mapping-row">
                        <div class="cell label">Mission 2</div>
                        <div class="cell mark"></div>
                        <div class="cell mark soft">‚úì</div>
                        <div class="cell mark strong">‚úì</div>
                        <div class="cell mark"></div>
                    </div>
                    <div class="mapping-row">
                        <div class="cell label">Mission 3</div>
                        <div class="cell mark soft"></div>
                        <div class="cell mark strong">‚úì</div>
                        <div class="cell mark"></div>
                        <div class="cell mark"></div>
                    </div>
                    <div class="mapping-row">
                        <div class="cell label">Mission 4</div>
                        <div class="cell mark"></div>
                        <div class="cell mark"></div>
                        <div class="cell mark soft"></div>
                        <div class="cell mark strong">‚úì</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- PO, Blooms, K, P, A Calculation Tables Section -->
{% if lifetime_stats %}
<section class="po-stats-section" id="marks-distribution-section" style="padding: 4rem 0; background: var(--bg-secondary);">
    <div class="container" style="max-width: 1400px; margin: 0 auto; padding: 0 2rem;">
        <div class="po-stats-header" style="text-align: center; margin-bottom: 3rem;">
            <p class="eyebrow" style="color: var(--text-secondary); font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.1em; margin: 0 0 0.5rem 0;">Program Outcomes</p>
            <h2 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 2rem; font-weight: 700;">You Should Know</h2>
            <p class="subtitle" style="color: var(--text-secondary); font-size: 1rem; max-width: 800px; margin: 0 auto;">
                <strong>Program Learning Outcomes (PLOs)</strong> are the most important aspect of your engineering education, aligned with the Washington Accord standards. These are high-level competencies you'll achieve upon graduation. PLOs are attained through <strong>Course Learning Outcomes (CLOs)</strong>, where each CLO maps to a specific PLO. We measure your progress using <strong>Bloom's Taxonomy across all 3 domains</strong> (Cognitive K1-K6, Affective A1-A5, Psychomotor P1-P5) and measuring tools <strong>Knowledge Profiles (K1-K8)</strong>, <strong>Problem Attributes (P1-P7)</strong>, and <strong>Activity Attributes (A1-A5)</strong> to ensure comprehensive development in all domains throughout your 4-year journey.
            </p>
        </div>

        <div style="text-align: center; margin-bottom: 2.5rem;">
            <h3 style="margin: 0; color: var(--text-primary); font-size: 1.8rem; font-weight: 700; line-height: 1.3;">
                The marks distribution of your 4-year BSc in CSE Program is as follows:
            </h3>
        </div>

        <div class="po-stats-tables" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
            <!-- Bloom's Taxonomy Section - Appears First -->
            <div style="grid-column: 1 / -1; margin-bottom: 1rem;">
                <h3 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.3rem; font-weight: 700; padding-bottom: 0.75rem; border-bottom: 2px solid var(--color-primary);">Bloom's Taxonomy Levels</h3>
            </div>
            
            <!-- Bloom's Taxonomy - Split into 3 Compact Cards -->
            <div class="blooms-cards-container" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; grid-column: 1 / -1;">
                <!-- Cognitive Domain Card -->
                <div class="stats-table-wrapper blooms-card" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1rem; box-shadow: 0 4px 12px var(--shadow);">
                    <h4 style="margin: 0 0 0.75rem 0; color: var(--color-primary); font-size: 0.95rem; font-weight: 700; padding-bottom: 0.5rem; border-bottom: 2px solid var(--color-primary);">Cognitive (K1-K6)</h4>
                    <div style="overflow-x: auto;">
                        <table class="stats-table" style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            <thead>
                                <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                    <th style="padding: 0.4rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Level</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Cr</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Mk</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">%</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for level in "K1,K2,K3,K4,K5,K6"|split_string:"," %}
                                {% with data=lifetime_stats.blooms|get_item:level %}
                                {% with total=lifetime_stats.totals.blooms %}
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.4rem; color: var(--text-primary); font-size: 0.75rem;"><strong>{{ level }}:</strong> {{ level|get_blooms_display }}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--text-secondary); font-size: 0.75rem;">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--text-secondary); font-size: 0.75rem;">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--color-primary); font-weight: 600; font-size: 0.75rem;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                                </tr>
                                {% endwith %}
                                {% endwith %}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Affective Domain Card -->
                <div class="stats-table-wrapper blooms-card" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1rem; box-shadow: 0 4px 12px var(--shadow);">
                    <h4 style="margin: 0 0 0.75rem 0; color: var(--color-primary); font-size: 0.95rem; font-weight: 700; padding-bottom: 0.5rem; border-bottom: 2px solid var(--color-primary);">Affective (A1-A5)</h4>
                    <div style="overflow-x: auto;">
                        <table class="stats-table" style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            <thead>
                                <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                    <th style="padding: 0.4rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Level</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Cr</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Mk</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">%</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for level in "A1,A2,A3,A4,A5"|split_string:"," %}
                                {% with data=lifetime_stats.blooms|get_item:level %}
                                {% with total=lifetime_stats.totals.blooms %}
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.4rem; color: var(--text-primary); font-size: 0.75rem;"><strong>{{ level }}:</strong> {{ level|get_blooms_display }}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--text-secondary); font-size: 0.75rem;">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--text-secondary); font-size: 0.75rem;">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--color-primary); font-weight: 600; font-size: 0.75rem;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                                </tr>
                                {% endwith %}
                                {% endwith %}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Psychomotor Domain Card -->
                <div class="stats-table-wrapper blooms-card" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1rem; box-shadow: 0 4px 12px var(--shadow);">
                    <h4 style="margin: 0 0 0.75rem 0; color: var(--color-primary); font-size: 0.95rem; font-weight: 700; padding-bottom: 0.5rem; border-bottom: 2px solid var(--color-primary);">Psychomotor (P1-P5)</h4>
                    <div style="overflow-x: auto;">
                        <table class="stats-table" style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                            <thead>
                                <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                    <th style="padding: 0.4rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Level</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Cr</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">Mk</th>
                                    <th style="padding: 0.4rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 1px solid var(--border-color); font-size: 0.8rem;">%</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for level in "P1,P2,P3,P4,P5"|split_string:"," %}
                                {% with data=lifetime_stats.blooms|get_item:level %}
                                {% with total=lifetime_stats.totals.blooms %}
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.4rem; color: var(--text-primary); font-size: 0.75rem;"><strong>{{ level }}:</strong> {{ level|get_blooms_display }}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--text-secondary); font-size: 0.75rem;">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--text-secondary); font-size: 0.75rem;">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                    <td style="padding: 0.4rem; text-align: center; color: var(--color-primary); font-weight: 600; font-size: 0.75rem;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                                </tr>
                                {% endwith %}
                                {% endwith %}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Program Outcomes Table -->
            <div class="stats-table-wrapper" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 12px var(--shadow);">
                <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem; font-weight: 700; padding-bottom: 0.75rem; border-bottom: 2px solid var(--color-primary);">Program Learning Outcomes (PLOs)</h4>
                <div style="overflow-x: auto;">
                    <table class="stats-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">PLO & Title</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Credits</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Marks</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">% of Marks</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if program_outcomes %}
                                {% for po in program_outcomes %}
                                {% with data=lifetime_stats.program_outcomes|get_item:po.code %}
                                {% with total=lifetime_stats.totals.program_outcomes %}
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.75rem; color: var(--text-primary);"><strong>{{ po.code|po_to_plo }}:</strong> {{ po.title }}</td>
                                    <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                    <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                    <td style="padding: 0.75rem; text-align: center; color: var(--color-primary); font-weight: 600;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                                </tr>
                                {% endwith %}
                                {% endwith %}
                                {% endfor %}
                            {% else %}
                                {% for po_num in "1,2,3,4,5,6,7,8,9,10,11,12"|split_string:"," %}
                                {% with po_code="PO"|add:po_num %}
                                {% with data=lifetime_stats.program_outcomes|get_item:po_code %}
                                {% with total=lifetime_stats.totals.program_outcomes %}
                                <tr style="border-bottom: 1px solid var(--border-color);">
                                    <td style="padding: 0.75rem; color: var(--text-primary);"><strong>{{ po_code|po_to_plo }}:</strong> -</td>
                                    <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                    <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                    <td style="padding: 0.75rem; text-align: center; color: var(--color-primary); font-weight: 600;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                                </tr>
                                {% endwith %}
                                {% endwith %}
                                {% endwith %}
                                {% endfor %}
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Knowledge Profiles Table -->
            <div class="stats-table-wrapper" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 12px var(--shadow);">
                <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem; font-weight: 700; padding-bottom: 0.75rem; border-bottom: 2px solid var(--color-primary);">Knowledge Profiles (K)</h4>
                <div style="overflow-x: auto;">
                    <table class="stats-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Profile</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Credits</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Marks</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">% of Marks</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for k in "K1,K2,K3,K4,K5,K6,K7,K8"|split_string:"," %}
                            {% with data=lifetime_stats.knowledge|get_item:k %}
                            {% with total=lifetime_stats.totals.knowledge %}
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: 0.75rem; color: var(--text-primary);"><strong>{{ k }}:</strong> {{ k|get_kp_display }}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--color-primary); font-weight: 600;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                            </tr>
                            {% endwith %}
                            {% endwith %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Problem Attributes Table -->
            <div class="stats-table-wrapper" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 12px var(--shadow);">
                <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem; font-weight: 700; padding-bottom: 0.75rem; border-bottom: 2px solid var(--color-primary);">Problem Attributes (P)</h4>
                <div style="overflow-x: auto;">
                    <table class="stats-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Attribute</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Credits</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Marks</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">% of Marks</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for p in "P1,P2,P3,P4,P5,P6,P7"|split_string:"," %}
                            {% with data=lifetime_stats.problem|get_item:p %}
                            {% with total=lifetime_stats.totals.problem %}
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: 0.75rem; color: var(--text-primary);"><strong>{{ p }}:</strong> {{ p|get_pa_display }}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--color-primary); font-weight: 600;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                            </tr>
                            {% endwith %}
                            {% endwith %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Activity Attributes Table -->
            <div class="stats-table-wrapper" style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 12px var(--shadow);">
                <h4 style="margin: 0 0 1rem 0; color: var(--text-primary); font-size: 1.1rem; font-weight: 700; padding-bottom: 0.75rem; border-bottom: 2px solid var(--color-primary);">Activity Attributes (A)</h4>
                <div style="overflow-x: auto;">
                    <table class="stats-table" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));">
                                <th style="padding: 0.75rem; text-align: left; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Attribute</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Credits</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">Marks</th>
                                <th style="padding: 0.75rem; text-align: center; font-weight: 600; color: var(--text-primary); border-bottom: 2px solid var(--border-color);">% of Marks</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for a in "A1,A2,A3,A4,A5"|split_string:"," %}
                            {% with data=lifetime_stats.activity|get_item:a %}
                            {% with total=lifetime_stats.totals.activity %}
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: 0.75rem; color: var(--text-primary);"><strong>{{ a }}:</strong> {{ a|get_a_display }}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.credits|floatformat:1 }}{% else %}0.0{% endif %}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--text-secondary);">{% if data %}{{ data.marks }}{% else %}0{% endif %}</td>
                                <td style="padding: 0.75rem; text-align: center; color: var(--color-primary); font-weight: 600;">{% if data and total > 0 %}{{ data.marks|mul:100|div:total|floatformat:1 }}%{% else %}0.0%{% endif %}</td>
                            </tr>
                            {% endwith %}
                            {% endwith %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Highlight Video Section -->
<section class="mvpeo-video-section">
    <div class="container mvpeo-video-container">
        <div class="mvpeo-video-header">
            <p class="eyebrow">See Us In Action</p>
            <h2>Experience CSE UAP</h2>
            <p class="subtitle">A quick glimpse into our campus, culture, and innovation.</p>
        </div>
        <div class="mvpeo-video-embed">
            <div class="embed-wrapper">
                <iframe width="560" height="315" src="https://www.youtube.com/embed/azdNa4-F6FQ?si=H5359DzjwLSwdmDf" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
            </div>
        </div>
    </div>
</section>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
    // Initialize Pie Chart for Home Page
    const typeChartHomeCtx = document.getElementById('typeChartHome');
    if (typeChartHomeCtx && typeof Chart !== 'undefined') {
        // Placeholder data - can be updated when type data is available
        // For now, using a simple distribution based on total publications
        const totalPubs = {{ research_stats.total_pubs|default:0 }};
        
        // Simple placeholder distribution (can be replaced with actual type data)
        const typeData = {
            labels: ['Journal', 'Conference', 'Book Chapter', 'Other'],
            datasets: [{
                data: totalPubs > 0 ? [
                    Math.round(totalPubs * 0.4),
                    Math.round(totalPubs * 0.35),
                    Math.round(totalPubs * 0.15),
                    Math.round(totalPubs * 0.1)
                ] : [1, 1, 1, 1],
                backgroundColor: [
                    'rgba(59, 130, 246, 0.8)',   // Journal - blue
                    'rgba(16, 185, 129, 0.8)',   // Conference - green
                    'rgba(139, 92, 246, 0.8)',   // Book Chapter - purple
                    'rgba(107, 114, 128, 0.8)',  // Other - gray
                ],
                borderColor: [
                    'rgb(59, 130, 246)',
                    'rgb(16, 185, 129)',
                    'rgb(139, 92, 246)',
                    'rgb(107, 114, 128)',
                ],
                borderWidth: 2
            }]
        };
        
        new Chart(typeChartHomeCtx, {
            type: 'pie',
            data: typeData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom'
                    },
                    tooltip: {
                        backgroundColor: 'rgba(0, 0, 0, 0.8)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 1
                    }
                }
            }
        });
    }
  const allCards = Array.from(document.querySelectorAll(".polaroid-link"));
  const visibleCount = 3;
  let index = 0;

  function getPositions() {
    const isMobile = window.innerWidth <= 768;
    return isMobile
      ? [
          { x: 20, y: 0, z: 3 },
          { x: 45, y: 25, z: 2 },
          { x: 70, y: 50, z: 1 },
        ]
      : [
          { x: 0, y: 0, z: 3 },
          { x: 45, y: 35, z: 2 },
          { x: 90, y: 70, z: 1 },
        ];
  }

  function showCards() {
    const positions = getPositions();

    // Hide all cards first
    allCards.forEach(card => {
      card.style.position = "absolute";
      card.style.transition = "transform 0.6s ease, opacity 0.6s ease";
      card.style.opacity = "0";
      card.style.pointerEvents = "none";
      card.style.zIndex = "0";
      card.style.transform = "translate(0,0)";
      const frame = card.querySelector(".polaroid-frame");
      frame.classList.remove("moving-forward", "moving-back");
    });

    // Show only visibleCount cards
    for (let i = 0; i < visibleCount; i++) {
      const card = allCards[(index + i) % allCards.length];
      const pos = positions[i];

      card.style.opacity = "1";
      card.style.pointerEvents = "auto";
      card.style.transform = `translate(${pos.x}px, ${pos.y}px)`;
      card.style.zIndex = pos.z;

      const frame = card.querySelector(".polaroid-frame");
      frame.classList.add(i === 0 ? "moving-forward" : "moving-back");
    }
  }

  // Initial load
  showCards();

  // Shuffle every 3 seconds
  setInterval(() => {
    index = (index + 1) % allCards.length;
    showCards();
  }, 3000);

  // Re-run on resize
  window.addEventListener("resize", showCards);
});
</script>


<style>
/* Prevent horizontal scrolling */
html, body {
    overflow-x: hidden;
    max-width: 100%;
    width: 100%;
}

.mvpeo-section {
    padding: 3rem 0 2rem;
    background: linear-gradient(180deg,
        color-mix(in srgb, var(--color-primary) 10%, transparent) 0%,
        color-mix(in srgb, var(--color-primary) 6%, transparent) 35%,
        transparent 100%);
}

.mvpeo-container {
    display: flex;
    flex-direction: column;
    gap: 2.5rem;
}

.mvpeo-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1.5rem;
    flex-wrap: wrap;
}

.eyebrow {
    text-transform: uppercase;
    letter-spacing: 0.08em;
    font-weight: 700;
    font-size: 0.8rem;
    color: var(--color-primary);
    margin-bottom: 0.35rem;
}

.mvpeo-header h2 {
    font-size: 2rem;
    margin-bottom: 0.35rem;
    color: var(--text-primary);
}

.subtitle {
    color: var(--text-secondary);
    margin: 0;
}

.mvpeo-badges {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.45rem 0.85rem;
    border-radius: 999px;
    font-weight: 700;
    font-size: 0.85rem;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-primary);
    position: relative;
    overflow: hidden;
    isolation: isolate;
}

.badge::before {
    content: "";
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    background: conic-gradient(from 90deg,
        color-mix(in srgb, var(--color-primary) 85%, transparent),
        color-mix(in srgb, var(--color-primary-hover) 85%, transparent),
        color-mix(in srgb, var(--color-primary) 85%, transparent));
    animation: badge-spin 4s linear infinite;
    z-index: 0;
}

.badge::after {
    content: "";
    position: absolute;
    inset: 2px;
    border-radius: inherit;
    background: var(--bg-secondary);
    z-index: 1;
}

.badge-label {
    position: relative;
    z-index: 2;
}

@keyframes badge-spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.mvpeo-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.mvpeo-title-row {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
}

.pill {
    padding: 0.45rem 1rem;
    border-radius: 999px;
    font-weight: 800;
    letter-spacing: 0.02em;
    border: 1px solid transparent;
}

.pill.primary {
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));
    color: white;
}

.pill.accent {
    background: linear-gradient(135deg, #5b8def, #4fd1c5);
    color: white;
}

.pill.neutral {
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border-color: var(--border-color);
}

.pill.outline {
    background: var(--bg-secondary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
}

.section-hint {
    margin: 0;
    color: var(--text-secondary);
    font-size: 0.95rem;
}

.card-grid {
    display: grid;
    gap: 1rem;
}

.card-grid.three {
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
}

.card-grid.four {
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.info-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 18px;
    padding: 1.25rem;
    box-shadow: 0 10px 30px rgba(0,0,0,0.06), 0 0 24px var(--shadow);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
}

.info-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 20% 20%, rgba(255,255,255,0.25), transparent 40%);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.info-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 16px 36px rgba(0,0,0,0.08), 0 0 32px var(--glow-shadow);
}

.info-card:hover::after {
    opacity: 1;
}

.card-icon {
    width: 42px;
    height: 42px;
    border-radius: 12px;
    display: grid;
    place-items: center;
    background: var(--bg-tertiary);
    color: var(--text-primary);
    font-size: 1.1rem;
    margin-bottom: 0.75rem;
}

.info-card h3 {
    margin: 0 0 0.35rem;
    font-size: 1.05rem;
    color: var(--text-primary);
}

.info-card p {
    margin: 0;
    color: var(--text-secondary);
    font-size: 0.95rem;
}

.mapping-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 18px;
    padding: 1.25rem;
    box-shadow: 0 12px 28px rgba(0,0,0,0.06);
}

.mvpeo-video-section {
    padding: 1rem 0 3rem;
}

.mvpeo-video-container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.mvpeo-video-header h3 {
    font-size: 1.5rem;
    margin: 0.1rem 0 0.35rem;
    color: var(--text-primary);
}

.mvpeo-video-embed .embed-wrapper {
    position: relative;
    width: 100%;
    padding-top: 56.25%;
    border-radius: 18px;
    overflow: hidden;
    box-shadow: 0 14px 32px rgba(0,0,0,0.08), 0 0 28px var(--shadow);
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
}

.mvpeo-video-embed iframe {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    border: 0;
}

.hod-section {
    padding: 2.5rem 0 1.5rem;
    background: linear-gradient(180deg,
        color-mix(in srgb, var(--color-primary) 8%, transparent) 0%,
        transparent 100%);
}

.hod-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.hod-card {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    padding: 1.75rem;
    box-shadow: 0 12px 30px rgba(0,0,0,0.07), 0 0 24px var(--shadow);
}

.hod-title-row {
    display: flex;
    justify-content: space-between;
    gap: 1rem;
    align-items: center;
    flex-wrap: wrap;
    margin-bottom: 1.25rem;
}

.hod-title-row h2 {
    margin: 0.15rem 0 0;
    color: var(--text-primary);
}

.hod-pill {
    padding: 0.45rem 0.9rem;
    border-radius: 999px;
    background: color-mix(in srgb, var(--color-primary) 18%, transparent);
    color: var(--color-primary-dark);
    font-weight: 700;
    border: 1px solid var(--border-color);
}

.hod-content {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 1.25rem;
    align-items: center;
}

.hod-profile {
    display: flex;
    gap: 0.85rem;
    align-items: center;
}

.hod-avatar {
    width: 86px;
    height: 86px;
    border-radius: 16px;
    overflow: hidden;
    border: 2px solid color-mix(in srgb, var(--color-primary) 35%, transparent);
    box-shadow: 0 10px 22px rgba(0,0,0,0.08);
    background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
    display: grid;
    place-items: center;
}

.hod-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.hod-meta h3 {
    margin: 0;
    font-size: 1.05rem;
    color: var(--text-primary);
}

.hod-meta p {
    margin: 0.15rem 0 0;
    color: var(--text-secondary);
    font-weight: 600;
    letter-spacing: 0.02em;
}

.hod-message {
    position: relative;
    padding-left: 1.5rem;
    color: var(--text-primary);
    line-height: 1.6;
}

.hod-quote-mark {
    position: absolute;
    left: 0;
    top: -0.4rem;
    font-size: 2.5rem;
    color: color-mix(in srgb, var(--color-primary) 45%, transparent);
    font-weight: 800;
}

.hod-message p {
    margin: 0 0 0.5rem;
}

.hod-read-more a {
    color: var(--color-primary);
    font-weight: 700;
    text-decoration: none;
}

.hod-read-more a:hover {
    color: var(--color-primary-hover);
}

.hod-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.hod-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
}

/* Head Message Modal - Glass Background */
.hod-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: color-mix(in srgb, var(--bg-primary) 85%, rgba(0, 0, 0, 0.5));
    z-index: 10000;
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    animation: fadeIn 0.3s ease;
    overflow-y: auto;
    padding: 2rem 1rem;
    /* Hide scrollbar */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
}

.hod-modal::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
}

.hod-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.hod-modal-content {
    background: color-mix(in srgb, var(--bg-secondary) 85%, rgba(255, 255, 255, 0.1));
    backdrop-filter: blur(20px) saturate(200%);
    -webkit-backdrop-filter: blur(20px) saturate(200%);
    border: 1px solid color-mix(in srgb, var(--border-color) 60%, rgba(255, 255, 255, 0.2));
    border-radius: 24px;
    width: 100%;
    max-width: 900px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4),
                0 0 0 1px color-mix(in srgb, var(--color-primary) 15%, transparent) inset;
    animation: slideUp 0.4s ease;
    position: relative;
    /* Hide scrollbar */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
}

.hod-modal-content::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
}

.hod-modal-header {
    padding: 2rem 2.5rem;
    border-bottom: 1px solid color-mix(in srgb, var(--border-color) 40%, transparent);
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    background: color-mix(in srgb, var(--bg-tertiary) 70%, rgba(255, 255, 255, 0.05));
    border-radius: 24px 24px 0 0;
    position: sticky;
    top: 0;
    z-index: 10;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.hod-modal-title-section .eyebrow {
    color: color-mix(in srgb, var(--text-secondary) 80%, var(--color-primary));
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin: 0 0 0.5rem 0;
}

.hod-modal-title-section h2 {
    margin: 0;
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--text-primary);
}

.hod-modal-close {
    background: color-mix(in srgb, var(--bg-tertiary) 80%, rgba(255, 255, 255, 0.1));
    border: 1px solid color-mix(in srgb, var(--border-color) 60%, rgba(255, 255, 255, 0.2));
    border-radius: 12px;
    padding: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-primary);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.hod-modal-close:hover {
    background: color-mix(in srgb, var(--color-primary) 20%, var(--bg-tertiary));
    border-color: var(--color-primary);
    color: var(--color-primary);
    transform: translateY(-2px) rotate(90deg);
    box-shadow: 0 4px 12px color-mix(in srgb, var(--color-primary) 30%, transparent);
}

.hod-modal-body {
    padding: 2.5rem;
    color: var(--text-primary);
}

.hod-modal-profile {
    display: flex;
    gap: 1.5rem;
    align-items: center;
    margin-bottom: 2.5rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid color-mix(in srgb, var(--border-color) 40%, transparent);
}

.hod-modal-avatar {
    width: 120px;
    height: 120px;
    border-radius: 20px;
    overflow: hidden;
    border: 3px solid color-mix(in srgb, var(--color-primary) 30%, var(--border-color));
    box-shadow: 0 10px 30px color-mix(in srgb, var(--color-primary) 15%, rgba(0, 0, 0, 0.2));
    background: color-mix(in srgb, var(--bg-tertiary) 80%, rgba(255, 255, 255, 0.1));
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    flex-shrink: 0;
}

.hod-modal-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.hod-modal-meta h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
    color: var(--text-primary);
}

.hod-modal-meta p {
    margin: 0;
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 1rem;
    letter-spacing: 0.02em;
}

.hod-modal-message {
    position: relative;
    padding-left: 3rem;
    line-height: 1.8;
}

.hod-modal-quote-mark {
    position: absolute;
    left: 0;
    top: -0.5rem;
    font-size: 4rem;
    color: color-mix(in srgb, var(--color-primary) 45%, transparent);
    font-weight: 800;
}

.hod-modal-text {
    font-size: 1.1rem;
    color: var(--text-primary);
}

.hod-modal-text p {
    margin: 0 0 1.5rem 0;
}

.hod-modal-text p:last-child {
    margin-bottom: 0;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 768px) {
    .hod-modal-content {
        max-width: 95vw;
        border-radius: 20px;
    }
    
    .hod-modal-header {
        padding: 1.5rem;
        flex-direction: column;
        gap: 1rem;
    }
    
    .hod-modal-title-section h2 {
        font-size: 1.5rem;
    }
    
    .hod-modal-body {
        padding: 1.5rem;
    }
    
    .hod-modal-profile {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
    
    .hod-modal-avatar {
        width: 100px;
        height: 100px;
    }
    
    .hod-modal-message {
        padding-left: 2rem;
    }
    
    .hod-modal-quote-mark {
        font-size: 3rem;
    }
    
    .hod-modal-text {
        font-size: 1rem;
    }
}

/* Marks Distribution Network Banner */

.marks-network-container {
    max-width: 900px;
    margin: 0 auto;
}
.marks-network-banner-wrapper {
    padding: 3rem 0 4rem 0;
    position: relative;
    margin-top: 1rem;
}

.marks-network-banner {
    position: relative;
    background: linear-gradient(135deg, 
        color-mix(in srgb, var(--color-primary) 5%, var(--bg-secondary)) 0%,
        color-mix(in srgb, var(--color-primary) 8%, var(--bg-secondary)) 50%,
        color-mix(in srgb, var(--color-primary-hover) 6%, var(--bg-secondary)) 100%
    );
    border-radius: 999px;
    padding: 1.75rem 2rem;
    cursor: pointer;
    overflow: hidden;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 
        0 8px 32px rgba(0, 0, 0, 0.1),
        0 0 0 1px color-mix(in srgb, var(--color-primary) 20%, transparent) inset;
    animation: subtlePulse 3s ease-in-out infinite;
}

.marks-network-banner:active {
    transform: scale(0.98) translateY(2px);
    box-shadow: 
        0 4px 16px rgba(0, 0, 0, 0.15),
        0 0 0 1px color-mix(in srgb, var(--color-primary) 25%, transparent) inset;
}

.marks-network-banner:hover {
    transform: translateY(-4px);
    box-shadow: 
        0 12px 40px rgba(0, 0, 0, 0.15),
        0 0 0 1px color-mix(in srgb, var(--color-primary) 30%, transparent) inset;
}

/* Animated Background Layers */
.marks-network-bg-animated {
    position: absolute;
    inset: 0;
    border-radius: 999px;
    overflow: hidden;
    z-index: 0;
}

.color-shift-layer {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        135deg,
        color-mix(in srgb, var(--color-primary) 8%, transparent) 0%,
        color-mix(in srgb, var(--color-primary-hover) 10%, transparent) 25%,
        color-mix(in srgb, var(--color-primary) 6%, transparent) 50%,
        color-mix(in srgb, var(--color-primary-hover) 9%, transparent) 75%,
        color-mix(in srgb, var(--color-primary) 8%, transparent) 100%
    );
    background-size: 300% 300%;
    animation: subtleColorFlow 12s ease-in-out infinite;
    opacity: 0.7;
}

@keyframes subtleColorFlow {
    0%, 100% {
        background-position: 0% 50%;
        opacity: 0.6;
    }
    25% {
        background-position: 50% 0%;
        opacity: 0.75;
    }
    50% {
        background-position: 100% 50%;
        opacity: 0.7;
    }
    75% {
        background-position: 50% 100%;
        opacity: 0.75;
    }
}

@keyframes gradient-flow {
    0%   { background-position: 0% 50%; }
    50%  { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes light-sweep {
    from { background-position: -240% 0; }
    to   { background-position: 240% 0; }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
    .marks-network-banner,
    .marks-network-bg-animation {
        animation: none;
    }
}

.marks-network-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    position: relative;
    z-index: 2;
    text-align: center;
    flex-wrap: wrap;
}


.marks-network-text {
    flex: 1 1 auto;
    min-width: 0;
    max-width: calc(100% - 40px);
}

.marks-network-tagline {
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    line-height: 1.4;
    letter-spacing: -0.01em;
    text-shadow: 
        0 2px 4px rgba(0, 0, 0, 0.1),
        0 0 20px color-mix(in srgb, var(--color-primary) 20%, transparent);
    position: relative;
    transition: all 0.3s ease;
    max-width: 100%;
    word-wrap: break-word;
    hyphens: auto;
}

.marks-network-banner:hover .marks-network-tagline {
    color: var(--text-primary);
    text-shadow: 
        0 3px 8px rgba(0, 0, 0, 0.15),
        0 0 30px color-mix(in srgb, var(--color-primary) 30%, transparent);
    transform: scale(1.01);
}

.marks-network-hint {
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-primary);
    opacity: 0.7;
    animation: subtleBounce 2s ease-in-out infinite;
    flex-shrink: 0;
}

.marks-network-hint svg {
    width: 20px;
    height: 20px;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}

.marks-network-banner:hover .marks-network-hint {
    opacity: 1;
    animation: subtleBounce 1s ease-in-out infinite;
}

@keyframes subtlePulse {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-2px);
    }
}

@keyframes subtleBounce {
    0%, 100% {
        transform: translateY(0);
        opacity: 0.6;
    }
    50% {
        transform: translateY(4px);
        opacity: 0.9;
    }
}


@media (max-width: 1024px) {
    .marks-network-container {
        max-width: 700px;
        padding: 0 1.25rem;
    }
    
    .marks-network-banner-wrapper {
        padding: 2rem 0 2.5rem 0;
        margin-top: 0.75rem;
    }
    
    .marks-network-banner {
        padding: 1.5rem 1.75rem;
    }
    
    .marks-network-tagline {
        font-size: 1rem;
    }
}

@media (max-width: 768px) {
    .marks-network-container {
        max-width: 100%;
    }
    
    .marks-network-banner-wrapper {
        padding: 1.75rem 0 2.25rem 0;
        margin-top: 0.5rem;
    }
    
    .marks-network-banner {
        padding: 1.4rem 1.5rem;
        border-radius: 999px;
    }
    
    .marks-network-tagline {
        font-size: 0.95rem;
        line-height: 1.5;
    }
    
    .marks-network-hint {
        display: none;
    }
}

@media (max-width: 480px) {
    .marks-network-banner-wrapper {
        padding: 1.5rem 0 2rem 0;
        margin-top: 0.5rem;
    }
    
    .marks-network-container {
        padding: 0 1rem;
    }
    
    .marks-network-banner {
        padding: 1.2rem 1.25rem;
        border-radius: 999px;
    }
    
    .marks-network-tagline {
        font-size: 0.9rem;
        line-height: 1.4;
    }
}

.uapnow-section {
    padding: 2.5rem 0 2rem;
    background: linear-gradient(180deg,
        color-mix(in srgb, var(--color-primary) 7%, transparent) 0%,
        color-mix(in srgb, var(--color-primary) 4%, transparent) 45%,
        transparent 100%);
    position: relative;
    overflow: hidden;
}

.uapnow-section::before,
.uapnow-section::after {
    content: "";
    position: absolute;
    width: 420px;
    height: 420px;
    border-radius: 50%;
    filter: blur(80px);
    opacity: 0.28;
    animation: floatGlow 18s ease-in-out infinite;
    pointer-events: none;
}

.uapnow-section::before {
    top: -120px;
    left: -140px;
    background: radial-gradient(circle at 30% 30%, color-mix(in srgb, var(--color-primary) 60%, transparent), transparent 70%);
}

.uapnow-section::after {
    bottom: -140px;
    right: -120px;
    background: radial-gradient(circle at 60% 60%, color-mix(in srgb, var(--color-primary-hover) 60%, transparent), transparent 70%);
    animation-delay: 6s;
}

.uapnow-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    position: relative;
    z-index: 1;
    max-width: 70rem; /* Reduced from default container width (85rem) */
}

.uapnow-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
    flex-wrap: wrap;
}

.view-all-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: white;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
    margin-top: 0.75rem;
    transition: all 0.3s ease;
    cursor: pointer;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    position: relative;
    z-index: 1;
    overflow: hidden;
    border: 2px solid transparent;
    background: linear-gradient(
        135deg,
        var(--color-primary) 0%,
        var(--color-primary-hover) 50%,
        var(--color-primary) 100%
    );
    background-size: 200% 200%;
    animation: colorShift 3s ease-in-out infinite;
}

.view-all-link::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.3),
        transparent
    );
    transition: left 0.5s ease;
}

.view-all-link:hover {
    gap: 0.75rem;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px color-mix(in srgb, var(--color-primary) 40%, transparent);
    animation-duration: 1.5s;
}

.view-all-link:hover::before {
    left: 100%;
}

.view-all-link:active {
    transform: translateY(0);
    animation-duration: 0.5s;
}

@keyframes colorShift {
    0%, 100% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
}

/* Browse More Faculties Button */
.browse-faculties-wrapper {
    display: flex;
    justify-content: center;
    margin-top: 2rem;
    padding: 0 1rem;
}

.browse-faculties-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
    padding: 0.75rem 1.5rem;
    border: 2px solid var(--color-primary);
    border-radius: 8px;
    background: transparent;
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.browse-faculties-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: var(--color-primary);
    transition: left 0.3s ease;
    z-index: -1;
}

.browse-faculties-btn:hover {
    color: white;
    gap: 0.75rem;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px color-mix(in srgb, var(--color-primary) 40%, transparent);
}

.browse-faculties-btn:hover::before {
    left: 0;
}

.browse-faculties-btn:active {
    transform: translateY(0);
}

.uapnow-filters {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.uapnow-chip {
    padding: 0.5rem 0.95rem;
    border-radius: 999px;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-primary);
    font-weight: 700;
    cursor: pointer;
    transition: all 0.25s ease;
    box-shadow: 0 6px 12px rgba(0,0,0,0.05);
    position: relative;
    overflow: hidden;
}

.uapnow-chip.active,
.uapnow-chip:hover {
    border-color: color-mix(in srgb, var(--color-primary) 35%, var(--border-color));
    box-shadow: 0 10px 18px rgba(0,0,0,0.08), 0 0 18px var(--shadow);
    transform: translateY(-2px);
    color: var(--text-primary);
}

.uapnow-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1rem;
}

.uapnow-card {
    background: var(--bg-secondary);
    border: 1px solid color-mix(in srgb, var(--border-color) 70%, var(--color-primary) 10%);
    border-radius: 16px;
    padding: 1.15rem;
    box-shadow: 0 14px 30px rgba(0,0,0,0.08), 0 0 24px var(--shadow);
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    backdrop-filter: blur(6px);
    min-height: 280px;
    transform-origin: center center;
}

/* ========== UAP CSE Now Carousel Animations ========== */

/* Cards that are about to leave - warning shake with glow */
.uapnow-card.about-to-leave {
    animation: aboutToLeave 0.8s ease-in-out;
    box-shadow: 0 0 30px rgba(255, 100, 100, 0.4), 0 14px 30px rgba(0,0,0,0.08) !important;
    border-color: rgba(255, 100, 100, 0.5) !important;
}

@keyframes aboutToLeave {
    0%, 100% { transform: translateX(0) rotate(0deg) scale(1); }
    10% { transform: translateX(-8px) rotate(-1deg) scale(0.98); }
    20% { transform: translateX(8px) rotate(1deg) scale(1.02); }
    30% { transform: translateX(-6px) rotate(-0.8deg) scale(0.99); }
    40% { transform: translateX(6px) rotate(0.8deg) scale(1.01); }
    50% { transform: translateX(-5px) rotate(-0.6deg) scale(0.99); }
    60% { transform: translateX(5px) rotate(0.6deg) scale(1.01); }
    70% { transform: translateX(-4px) rotate(-0.4deg) scale(1); }
    80% { transform: translateX(4px) rotate(0.4deg) scale(1); }
    90% { transform: translateX(-2px) rotate(-0.2deg) scale(1); }
}

/* Card leaving animation - dramatic exit with flip */
.uapnow-card.leaving {
    animation: cardLeave 0.6s cubic-bezier(0.4, 0, 1, 1) forwards;
    pointer-events: none;
    z-index: 100;
}

@keyframes cardLeave {
    0% {
        opacity: 1;
        transform: scale(1) translateY(0) rotateX(0) rotateY(0);
        filter: blur(0);
    }
    30% {
        opacity: 0.9;
        transform: scale(1.05) translateY(-20px) rotateX(-10deg) rotateY(5deg);
        filter: blur(0);
    }
    100% {
        opacity: 0;
        transform: scale(0.6) translateY(-80px) rotateX(-30deg) rotateY(15deg);
        filter: blur(12px);
    }
}

/* Card entering animation - dramatic entrance with bounce */
.uapnow-card.entering {
    animation: cardEnter 0.7s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    z-index: 50;
}

@keyframes cardEnter {
    0% {
        opacity: 0;
        transform: scale(0.5) translateY(100px) rotateX(30deg);
        filter: blur(15px);
    }
    50% {
        opacity: 0.9;
        transform: scale(1.05) translateY(-10px) rotateX(-5deg);
        filter: blur(2px);
    }
    70% {
        transform: scale(0.98) translateY(5px) rotateX(2deg);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0) rotateX(0);
        filter: blur(0);
    }
}

/* Progress timer bar on non-pinned cards */
.uapnow-card[data-pinned="false"]::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    height: 4px;
    width: 0%;
    background: linear-gradient(90deg, 
        #667eea 0%, 
        #764ba2 30%,
        #f093fb 60%,
        #4facfe 100%
    );
    background-size: 200% 100%;
    border-radius: 0 0 16px 16px;
    z-index: 20;
    box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
}

.uapnow-card[data-pinned="false"].timer-active::after {
    animation: timerProgress 4s linear forwards, timerGlow 1s ease-in-out infinite;
}

@keyframes timerProgress {
    0% { width: 0%; }
    100% { width: 100%; }
}

@keyframes timerGlow {
    0%, 100% { 
        box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        background-position: 0% 50%;
    }
    50% { 
        box-shadow: 0 0 20px rgba(240, 147, 251, 0.7);
        background-position: 100% 50%;
    }
}

/* Pinned badge glow effect */
.uapnow-card.uapnow-pinned {
    border: 1px solid color-mix(in srgb, var(--color-primary) 40%, var(--border-color) 60%);
    box-shadow: 0 14px 30px rgba(0,0,0,0.08), 0 0 24px var(--shadow), 0 0 20px color-mix(in srgb, var(--color-primary) 15%, transparent);
}

/* Carousel controls */
.uapnow-carousel-controls {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-top: 1rem;
}

.uapnow-carousel-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    color: var(--text-secondary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.uapnow-carousel-btn:hover {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
    transform: scale(1.1);
}

.uapnow-carousel-btn:active {
    transform: scale(0.95);
}

.uapnow-carousel-btn svg {
    width: 16px;
    height: 16px;
}

.uapnow-carousel-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
}

.uapnow-carousel-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--border-color);
    transition: all 0.3s ease;
    cursor: pointer;
}

.uapnow-carousel-dot.active {
    width: 24px;
    border-radius: 4px;
    background: linear-gradient(90deg, var(--color-primary), #f093fb);
}

.uapnow-carousel-dot:hover:not(.active) {
    background: var(--text-secondary);
    transform: scale(1.2);
}

.uapnow-carousel-status {
    font-size: 0.75rem;
    color: var(--text-secondary);
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.uapnow-carousel-status .pause-icon {
    width: 14px;
    height: 14px;
    cursor: pointer;
    opacity: 0.7;
    transition: all 0.2s ease;
}

.uapnow-carousel-status .pause-icon:hover {
    opacity: 1;
    color: var(--color-primary);
}

/* Hidden card state */
.uapnow-card.carousel-hidden {
    display: none !important;
}

.uapnow-card-with-thumbnail {
    min-height: 280px;
}

.uapnow-card-with-thumbnail {
    padding: 0;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    object-fit: cover;
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
}

.uapnow-card-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    width: 100%;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.75) 40%, rgba(0, 0, 0, 0.4) 70%, rgba(0, 0, 0, 0) 100%);
    padding: 1.5rem 1rem 1rem 1rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 10;
}

.uapnow-card:hover .uapnow-card-overlay {
    padding: 1.75rem 1.25rem 1.25rem 1.25rem;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.8) 40%, rgba(0, 0, 0, 0.5) 70%, rgba(0, 0, 0, 0) 100%);
}

.uapnow-card-info {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    position: relative;
    width: 100%;
}

.uapnow-card-title {
    font-size: 1rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    line-height: 1.3;
}

.uapnow-card-with-thumbnail .uapnow-card-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: white;
    margin: 0;
    line-height: 1.2;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.uapnow-card:hover.uapnow-card-with-thumbnail .uapnow-card-title {
    font-size: 1.2rem;
}

.uapnow-card-description {
    font-size: 0.85rem;
    color: var(--text-secondary);
    line-height: 1.4;
    margin: 0;
    flex-grow: 1;
}

.uapnow-card-with-thumbnail .uapnow-card-description {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.9);
    line-height: 1.3;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.uapnow-card:hover.uapnow-card-with-thumbnail .uapnow-card-description {
    font-size: 0.85rem;
}

.uapnow-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 18px 34px rgba(0,0,0,0.1), 0 0 26px var(--glow-shadow);
}

.uapnow-card::before {
    content: "";
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    background: linear-gradient(135deg,
        color-mix(in srgb, var(--color-primary) 28%, transparent),
        transparent 35%,
        color-mix(in srgb, var(--color-primary-hover) 22%, transparent) 70%);
    opacity: 0.18;
    filter: blur(12px);
    z-index: 0;
}

.uapnow-card-with-thumbnail::before {
    display: none;
}

.uapnow-card::after {
    content: "";
    position: absolute;
    top: -40%;
    left: -20%;
    width: 80%;
    height: 80%;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18), transparent 55%);
    transform: rotate(8deg);
    opacity: 0.5;
    animation: sheen 10s ease-in-out infinite;
    pointer-events: none;
    z-index: 0;
}

.uapnow-card-with-thumbnail::after {
    display: none;
}

.uapnow-card > * {
    position: relative;
    z-index: 1;
}

.uapnow-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;
}

.uapnow-badge {
    padding: 0.35rem 0.75rem;
    border-radius: 12px;
    font-weight: 800;
    font-size: 0.85rem;
    background: var(--bg-tertiary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
    box-shadow: 0 0 0 1px color-mix(in srgb, var(--color-primary) 25%, transparent),
                0 12px 24px rgba(0,0,0,0.08),
                0 0 18px color-mix(in srgb, var(--color-primary) 30%, transparent);
}

.uapnow-badge.notice { background: color-mix(in srgb, var(--color-primary) 14%, var(--bg-tertiary)); }
.uapnow-badge.events { background: color-mix(in srgb, var(--color-primary-hover) 14%, var(--bg-tertiary)); }
.uapnow-badge.seminars { background: color-mix(in srgb, var(--color-primary) 12%, var(--bg-secondary)); }
.uapnow-badge.workshop { background: color-mix(in srgb, var(--color-primary-dark) 12%, var(--bg-secondary)); }
.uapnow-badge.others { background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-tertiary)); }

/* Pinned post styling */
.uapnow-card.uapnow-pinned {
    border-color: color-mix(in srgb, var(--color-primary) 40%, var(--border-color));
    box-shadow: 0 14px 30px rgba(0,0,0,0.1), 0 0 24px var(--shadow), 0 0 0 2px color-mix(in srgb, var(--color-primary) 20%, transparent);
}

.uapnow-badge.pinned {
    background: color-mix(in srgb, var(--color-primary) 20%, var(--bg-tertiary));
    border-color: color-mix(in srgb, var(--color-primary) 40%, var(--border-color));
}

.pin-icon {
    display: inline-flex;
    align-items: center;
    margin-right: 0.25rem;
    vertical-align: middle;
}

.pin-icon svg {
    width: 12px;
    height: 12px;
    stroke-width: 2.5;
}

.uapnow-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
}

.tag.soft {
    padding: 0.25rem 0.6rem;
    border-radius: 999px;
    background: color-mix(in srgb, var(--color-primary) 8%, var(--bg-secondary));
    color: var(--text-primary);
    border: 1px solid var(--border-color);
    font-size: 0.85rem;
    font-weight: 700;
}

.uapnow-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.75rem;
    flex-wrap: wrap;
}

.uapnow-date {
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 0.9rem;
}

.uapnow-card h3 {
    margin: 0.1rem 0;
    color: var(--text-primary);
}

.uapnow-card p {
    margin: 0;
    color: var(--text-secondary);
    line-height: 1.55;
}

.uapnow-link {
    margin-top: auto;
    color: var(--color-primary);
    font-weight: 700;
    text-decoration: none;
}

.uapnow-link:hover {
    color: var(--color-primary-hover);
}

/* Club Badge Styles */
.uapnow-club-badge {
    margin-bottom: 0.5rem;
}

.uapnow-club-badge .club-link {
    display: inline-block;
    padding: 0.25rem 0.6rem;
    background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-tertiary));
    border: 1px solid color-mix(in srgb, var(--color-primary) 30%, var(--border-color));
    border-radius: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--color-primary);
    text-decoration: none;
    transition: all 0.3s ease;
}

.uapnow-club-badge .club-link:hover {
    background: color-mix(in srgb, var(--color-primary) 20%, var(--bg-tertiary));
    border-color: var(--color-primary);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px color-mix(in srgb, var(--color-primary) 20%, transparent);
}

.uapnow-anim {
    background: linear-gradient(120deg,
        color-mix(in srgb, var(--color-primary) 95%, transparent),
        color-mix(in srgb, var(--color-primary-hover) 95%, transparent),
        color-mix(in srgb, var(--color-primary-dark) 95%, transparent));
    background-size: 900% 250%;
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: uapnowShift 4.5s ease-in-out infinite;
    display: inline-block;
}

.uapnow-title {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 2.25rem;
    line-height: 1.15;
    margin: 0.2rem 0 0;
}

.uapnow-star {
    display: contents;
    color: var(--color-primary);
    font-size: 1.25em;
    font-weight: 900;
    opacity: 0.95;
    animation: starTwinkle 2.2s ease-in-out infinite,
               starFloat 3.5s ease-in-out infinite;
}

@keyframes starTwinkle {
    0% {
        opacity: 0.9;
        filter: drop-shadow(0 0 0px var(--color-primary));
        transform: scale(1);
    }
    50% {
        opacity: 1;
        filter: drop-shadow(0 0 4px var(--color-primary));
        transform: scale(1.08);
    }
    100% {
        opacity: 0.9;
        filter: drop-shadow(0 0 0px var(--color-primary));
        transform: scale(1);
    }
}

@keyframes starFloat {
    0% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-3px);
    }
    100% {
        transform: translateY(0);
    }
}


.uapnow-chip::before {
    content: "";
    position: absolute;
    inset: -120%;
    background: linear-gradient(120deg, transparent, color-mix(in srgb, var(--color-primary) 30%, transparent), transparent);
    transform: rotate(20deg);
    animation: sweep 5s linear infinite;
    opacity: 0.6;
}

@keyframes uapnowShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes starTwinkle {
    0% { transform: translateY(0) translateX(0) scale(1); opacity: 0.55; }
    40% { transform: translateY(-3px) translateX(2px) scale(1.12); opacity: 1; }
    70% { transform: translateY(-1px) translateX(-2px) scale(1.05); opacity: 0.8; }
    100% { transform: translateY(0) translateX(0) scale(1); opacity: 0.6; }
}

@keyframes sweep {
    0% { transform: translateX(-50%) rotate(20deg); }
    100% { transform: translateX(120%) rotate(20deg); }
}

@keyframes floatGlow {
    0%, 100% { transform: translate(0, 0) scale(1); opacity: 0.26; }
    50% { transform: translate(30px, -20px) scale(1.05); opacity: 0.34; }
}

@keyframes sheen {
    0% { transform: translate(-20%, -10%) rotate(8deg); opacity: 0.35; }
    50% { transform: translate(30%, 10%) rotate(12deg); opacity: 0.18; }
    100% { transform: translate(-20%, -10%) rotate(8deg); opacity: 0.35; }
}
@media (max-width: 1024px) {

    .uapnow-title {
        font-size: 1.9rem;
    }

    .uapnow-grid {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 0.9rem;
    }

    .uapnow-card {
        padding: 1rem;
    }

    .uapnow-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.75rem;
    }
}
@media (max-width: 768px) {

    .uapnow-section {
        padding: 2rem 0 1.5rem;
    }

    .uapnow-title {
        font-size: 1.65rem;
        gap: 0.4rem;
    }

    .uapnow-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.75rem;
    }

    .uapnow-card {
        padding: 0.9rem;
        border-radius: 12px;
    }

    .uapnow-card-with-thumbnail {
        padding: 0 !important; /* Ensure no padding on thumbnail cards */
        min-height: 240px; /* Reduced min-height for mobile */
    }

    .uapnow-card-overlay {
        padding: 1.25rem 0.9rem 0.9rem 0.9rem; /* Adjusted padding for mobile */
    }

    .uapnow-card-with-thumbnail .uapnow-card-title {
        font-size: 1rem; /* Slightly smaller for mobile */
    }

    .uapnow-card-with-thumbnail .uapnow-card-description {
        font-size: 0.75rem; /* Smaller for mobile */
    }

    .uapnow-top {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.45rem;
    }

    .uapnow-filters {
        justify-content: flex-start;
        gap: 0.4rem;
    }

    .uapnow-chip {
        padding: 0.45rem 0.85rem;
        font-size: 0.85rem;
    }

    .uapnow-badge {
        font-size: 0.78rem;
        padding: 0.3rem 0.65rem;
    }
}
@media (max-width: 480px) {

    .uapnow-title {
        font-size: 1.45rem;
    }

    .uapnow-grid {
        grid-template-columns: 1fr;
    }

    .uapnow-card {
        padding: 0.85rem;
        gap: 0.4rem;
        border-radius: 10px;
    }

    .uapnow-card-with-thumbnail {
        padding: 0 !important; /* Ensure no padding on thumbnail cards */
        min-height: 220px; /* Further reduced for small mobile */
    }

    .uapnow-card-overlay {
        padding: 1rem 0.75rem 0.75rem 0.75rem; /* Smaller padding for small mobile */
    }

    .uapnow-card-with-thumbnail .uapnow-card-title {
        font-size: 0.95rem; /* Smaller for small mobile */
    }

    .uapnow-card-with-thumbnail .uapnow-card-description {
        font-size: 0.7rem; /* Smaller for small mobile */
    }

    .uapnow-meta {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.4rem;
    }

    .uapnow-date {
        font-size: 0.82rem;
    }

    .uapnow-card h3 {
        font-size: 1.05rem;
    }

    .uapnow-card p {
        font-size: 0.9rem;
    }
}

/* Easy Access Section */
.easy-access-section {
    padding: 2.5rem 0;
    background: linear-gradient(180deg,
        color-mix(in srgb, var(--color-primary) 5%, transparent) 0%,
        transparent 100%);
}

.easy-access-container {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.easy-access-header {
    text-align: center;
}

.easy-access-header h2 {
    font-size: 2rem;
    margin: 0.35rem 0;
    color: var(--text-primary);
}

.easy-access-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 1.25rem;
    max-width: 1200px;
    margin: 0 auto;
}

.easy-access-tile {
    background: var(--bg-secondary);
    border: 2px solid var(--border-color);
    border-radius: 16px;
    padding: 1.5rem 1rem;
    text-decoration: none;
    color: inherit;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: relative;
    overflow: hidden;
    isolation: isolate;
}

.easy-access-tile {
    background: var(--bg-secondary);
    border: 2px solid var(--border-color);
    border-radius: 16px;
    padding: 1.5rem 1rem;
    text-decoration: none;
    color: inherit;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    position: relative;
    overflow: hidden;
    isolation: isolate;
}

/* Glowing animated outline */
.easy-access-tile::before {
    content: "";
    position: absolute;
    inset: -3px;
    border-radius: 18px;
    padding: 3px;
    background: linear-gradient(45deg,
        var(--color-primary),
        var(--color-primary-hover),
        #00d4ff,
        var(--color-primary-hover),
        var(--color-primary));
    background-size: 400% 400%;
    -webkit-mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
    mask-composite: exclude;
    opacity: 0;
    animation: glow-border 3s linear infinite;
    z-index: -1;
    transition: opacity 0.4s ease;
}

.easy-access-tile:hover::before {
    opacity: 1;
}

@keyframes glow-border {
    0% {
        background-position: 0% 50%;
    }
    50% {
        background-position: 100% 50%;
    }
    100% {
        background-position: 0% 50%;
    }
}

.easy-access-tile::after {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 50% 0%, color-mix(in srgb, var(--color-primary) 12%, transparent), transparent 60%);
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: 0;
}

.easy-access-tile:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1), 0 0 32px color-mix(in srgb, var(--color-primary) 25%, transparent);
    border-color: color-mix(in srgb, var(--color-primary) 50%, var(--border-color));
}

.easy-access-tile:hover::after {
    opacity: 1;
}

.easy-access-tile > * {
    position: relative;
    z-index: 1;
}

.tile-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: linear-gradient(135deg, color-mix(in srgb, var(--color-primary) 18%, transparent), color-mix(in srgb, var(--color-primary-hover) 12%, transparent));
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.75rem;
    color: var(--color-primary);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.easy-access-tile:hover .tile-icon {
    transform: scale(1.15) rotate(5deg);
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));
    color: white;
    box-shadow: 0 4px 12px color-mix(in srgb, var(--color-primary) 30%, transparent);
}

.easy-access-tile h3 {
    margin: 0;
    font-size: 1rem;
    font-weight: 700;
    color: var(--text-primary);
    transition: color 0.3s ease;
}

.easy-access-tile:hover h3 {
    color: var(--color-primary);
}

@media (max-width: 900px) {
    .hod-content {
        grid-template-columns: 1fr;
    }
    .hod-profile {
        justify-content: flex-start;
    }
    .uapnow-header {
        flex-direction: column;
        align-items: flex-start;
    }
    .easy-access-section {
        padding: 2rem 0;
    }
    .easy-access-container {
        gap: 1.5rem;
    }
    .easy-access-header h2 {
        font-size: 1.75rem;
    }
    .easy-access-grid {
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 1rem;
    }

    .easy-access-tile {
        padding: 1.25rem 0.75rem;
    }

    .tile-icon {
        width: 42px;
        height: 42px;
        margin-bottom: 0.6rem;
    }

    .easy-access-tile h3 {
        font-size: 0.9rem;
    }
}

@media (max-width: 768px) {
    .easy-access-section {
        padding: 1.5rem 0;
    }
    .easy-access-container {
        gap: 1.25rem;
    }
    .easy-access-header h2 {
        font-size: 1.5rem;
    }
    .easy-access-header .subtitle {
        font-size: 0.9rem;
    }
    .easy-access-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.875rem;
        max-width: 100%;
    }

    .easy-access-tile {
        padding: 1rem 0.5rem;
        min-height: 100px;
    }

    .tile-icon {
        width: 40px;
        height: 40px;
        margin-bottom: 0.5rem;
    }

    .tile-icon svg {
        width: 18px;
        height: 18px;
    }

    .easy-access-tile h3 {
        font-size: 0.85rem;
        line-height: 1.3;
    }
}

@media (max-width: 480px) {
    .easy-access-section {
        padding: 1.25rem 0;
    }
    .easy-access-container {
        gap: 1rem;
    }
    .easy-access-header {
        padding: 0 0.5rem;
    }
    .easy-access-header h2 {
        font-size: 1.35rem;
    }
    .easy-access-header .eyebrow {
        font-size: 0.75rem;
    }
    .easy-access-header .subtitle {
        font-size: 0.85rem;
        padding: 0 0.5rem;
    }
    .easy-access-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
        padding: 0 0.5rem;
    }

    .easy-access-tile {
        padding: 0.875rem 0.4rem;
        min-height: 90px;
        border-radius: 12px;
    }

    .tile-icon {
        width: 36px;
        height: 36px;
        border-radius: 10px;
        margin-bottom: 0.4rem;
    }

    .tile-icon svg {
        width: 16px;
        height: 16px;
    }

    .easy-access-tile h3 {
        font-size: 0.8rem;
        line-height: 1.2;
    }
}

/* Research and Publications Section */
.research-home-section {
    padding: 1.75rem 0;
    background: linear-gradient(180deg,
        transparent 0%,
        color-mix(in srgb, var(--color-primary) 5%, transparent) 100%);
    overflow-x: hidden;
    width: 100%;
    max-width: 100%;
}

.research-home-container {
    display: flex;
    flex-direction: column;
    gap: 1.75rem;
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    box-sizing: border-box;
}

.research-home-header {
    text-align: center;
    margin-bottom: 0.5rem;
}

.research-home-header h2 {
    font-size: 1.75rem;
    margin: 0.25rem 0;
    color: var(--text-primary);
}

/* Stats with Chart Container */
.research-stats-with-chart {
    display: grid;
    grid-template-columns: 0.7fr 1.3fr;
    gap: 2rem;
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    box-sizing: border-box;
    padding: 0 1rem;
    align-items: stretch;
}

.pie-chart-wrapper-home {
    position: sticky;
    top: 2rem;
    width: 100%;
    min-width: 0;
    height: 100%;
    display: flex;
    align-items: stretch;
}

.chart-card-home {
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    width: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    height: 100%;
}

.chart-card-home:hover {
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.chart-header-home {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--border-color);
}

.chart-title-home {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
}

.chart-wrapper-home {
    position: relative;
    flex: 1;
    width: 100%;
    min-height: 300px;
}

.stats-cards-wrapper-home {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
    width: 100%;
    min-width: 0;
    height: 100%;
    justify-content: space-between;
}

.stats-row-top-home {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.25rem;
    width: 100%;
}

.stats-row-bottom-home {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    width: 100%;
}

.research-stats-row {
    display: grid;
    grid-template-columns: repeat(12, 1fr);
    grid-template-rows: repeat(2, minmax(160px, auto));
    gap: 1.25rem;
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    box-sizing: border-box;
    padding: 0 1rem;
}

.stat-large-home {
    padding: 2rem 1.5rem;
}

.stat-large-home .research-stat-value {
    font-size: 2.75rem;
}

.stat-large-home .research-stat-label {
    font-size: 1.05rem;
    font-weight: 600;
}

.stat-compact-home {
    padding: 1.5rem 1.25rem;
}

.stat-compact-home .stat-icon {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.stat-compact-home .research-stat-value {
    font-size: 1rem;
}

.stat-compact-home .research-stat-label {
    font-size: 0.5rem;
}

.research-stat-item {
    background: var(--bg-secondary);
    border: 2px solid var(--border-color);
    border-radius: 20px;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-sizing: border-box;
    min-width: 0;
    width: 100%;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.research-stat-item::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, 
        color-mix(in srgb, var(--color-primary) 8%, transparent) 0%,
        color-mix(in srgb, var(--color-primary) 4%, transparent) 100%);
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: 0;
}

.research-stat-item:hover::before {
    opacity: 1;
}

.research-stat-item:hover {
    transform: translateY(-8px) scale(1.03);
    box-shadow: 0 16px 40px color-mix(in srgb, var(--color-primary) 20%, transparent);
    border-color: var(--color-primary);
}

.stat-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
    opacity: 0.8;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    position: relative;
    z-index: 1;
}

.research-stat-item:hover .stat-icon {
    transform: scale(1.2) rotate(10deg);
    opacity: 1;
}

/* Total Citations - Biggest on the Left */
.stat-citations {
    grid-column: 1 / span 5;
    grid-row: 1 / span 2;
    background: linear-gradient(135deg, 
        color-mix(in srgb, var(--color-primary) 18%, var(--bg-secondary)) 0%,
        color-mix(in srgb, var(--color-primary-hover) 12%, var(--bg-secondary)) 50%,
        color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary)) 100%);
    border-color: color-mix(in srgb, var(--color-primary) 45%, transparent);
    padding: 3rem 2.5rem;
    border-width: 3px;
}

.stat-citations .stat-icon {
    font-size: 4.5rem;
    margin-bottom: 1.25rem;
}

.stat-citations .research-stat-value {
    font-size: 4rem;
    margin-bottom: 0.75rem;
}

.stat-citations .research-stat-label {
    font-size: 1.2rem;
    font-weight: 700;
}

/* Total Publications - Takes remaining width on right */
.stat-publications {
    grid-column: 6 / span 7;
    grid-row: 1 / span 2;
    background: linear-gradient(135deg, 
        color-mix(in srgb, var(--color-primary) 14%, var(--bg-secondary)) 0%,
        color-mix(in srgb, var(--color-primary-hover) 9%, var(--bg-secondary)) 100%);
    border-color: color-mix(in srgb, var(--color-primary) 38%, transparent);
    padding: 2.5rem 2rem;
    border-width: 2.5px;
}

.stat-publications .stat-icon {
    font-size: 3.5rem;
    margin-bottom: 1rem;
}

.stat-publications .research-stat-value {
    font-size: 3rem;
    margin-bottom: 0.5rem;
}

.stat-publications .research-stat-label {
    font-size: 1.05rem;
    font-weight: 600;
}

/* Bottom Cards - Below Total Publications */
.stat-bottom {
    grid-row: 2;
    padding: 1.75rem 1.5rem;
}

.stat-bottom:nth-of-type(3) {
    grid-column: 6 / span 2;
}

.stat-bottom:nth-of-type(4) {
    grid-column: 8 / span 2;
}

.stat-bottom:nth-of-type(5) {
    grid-column: 10 / span 3;
}

.stat-bottom .stat-icon {
    font-size: 2rem;
    margin-bottom: 0.75rem;
}

.stat-bottom .research-stat-value {
    font-size: 1.9rem;
    margin-bottom: 0.5rem;
}

.stat-bottom .research-stat-label {
    font-size: 0.9rem;
    font-weight: 500;
}

.research-stat-value {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-primary);
    margin-bottom: 0.5rem;
    transition: all 0.3s ease;
    display: inline-block;
    position: relative;
    z-index: 1;
}

.research-stat-value.animated {
    animation: pulse 0.5s ease;
}

@keyframes pulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.1);
    }
}

.research-stat-label {
    font-size: 0.85rem;
    color: var(--text-secondary);
    font-weight: 500;
    position: relative;
    z-index: 1;
}

.top-researchers-home {
    margin-top: 0.5rem;
}

.top-researchers-header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    margin-bottom: 1.25rem;
}

.top-researchers-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0;
}

.info-btn-home {
    background: transparent;
    border: 2px solid var(--border-color);
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    color: var(--text-secondary);
    padding: 0;
}

.info-btn-home:hover {
    background: color-mix(in srgb, var(--color-primary) 10%, transparent);
    border-color: var(--color-primary);
    color: var(--color-primary);
    transform: scale(1.1);
}

.info-btn-home svg {
    width: 18px;
    height: 18px;
}

.top-researchers-grid-home {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    box-sizing: border-box;
    padding: 0 1rem;
}

.top-researcher-card-home {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    min-width: 0;
    width: 100%;
}

.researcher-card-home-image {
    position: relative;
    width: 100%;
    max-width: 100%;
    aspect-ratio: 3/4;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-sizing: border-box;
}

.top-researcher-card-home:hover .researcher-card-home-image {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
}

.researcher-card-home-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.top-researcher-card-home:hover .researcher-card-home-image img {
    transform: scale(1.05);
}

.researcher-card-home-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.85) 0%, rgba(0, 0, 0, 0.7) 50%, rgba(0, 0, 0, 0) 100%);
    padding: 1rem 0.75rem 0.75rem 0.75rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.top-researcher-card-home:hover .researcher-card-home-overlay {
    padding: 1.25rem 1rem 1rem 1rem;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.75) 50%, rgba(0, 0, 0, 0) 100%);
}

.researcher-card-home-info {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
}

.researcher-name-home {
    font-size: 1rem;
    font-weight: 700;
    margin: 0;
    color: white;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    line-height: 1.2;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.top-researcher-card-home:hover .researcher-name-home {
    font-size: 1.1rem;
}

.researcher-citation-home {
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.9);
    font-weight: 500;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.researcher-designation-home {
    font-size: 0.85rem;
    color: var(--text-secondary);
    font-weight: 500;
    text-align: center;
    margin-top: 0.25rem;
}

.researcher-meta-home {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.researcher-score-home,
.researcher-pubs-home {
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.9);
    font-weight: 500;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.empty-message-home {
    text-align: center;
    padding: 2rem;
    color: var(--text-secondary);
    font-style: italic;
    grid-column: 1 / -1;
}

/* Researcher Tabs */
.researchers-tabs-home {
    display: flex;
    justify-content: center;
    gap: 0;
    margin-bottom: 1.5rem;
    border-bottom: 2px solid var(--border-color);
    position: relative;
}

.researcher-tab-btn-home {
    padding: 0.875rem 1.75rem;
    background: transparent;
    border: none;
    border-bottom: 3px solid transparent;
    color: var(--text-secondary);
    font-size: 0.95rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: -2px;
    position: relative;
    border-radius: 8px 8px 0 0;
}

.researcher-tab-btn-home:hover {
    color: var(--color-primary);
    background: color-mix(in srgb, var(--color-primary) 5%, transparent);
}

.researcher-tab-btn-home {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    position: relative;
}

.researcher-tab-btn-home.active {
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
    font-weight: 600;
    background: color-mix(in srgb, var(--color-primary) 3%, transparent);
    animation: tabPulse 2s ease-in-out infinite;
}

.tab-info-btn-home {
    background: transparent;
    border: none;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    border-radius: 50%;
    transition: all 0.3s ease;
    color: var(--text-secondary);
    flex-shrink: 0;
}

.tab-info-btn-home:hover {
    background: color-mix(in srgb, var(--color-primary) 15%, transparent);
    color: var(--color-primary);
    transform: scale(1.1);
}

.tab-info-btn-home svg {
    width: 14px;
    height: 14px;
}

.researcher-tab-btn-home.active .tab-info-btn-home {
    color: var(--color-primary);
}

.researcher-tab-btn-home.active .tab-info-btn-home:hover {
    background: color-mix(in srgb, var(--color-primary) 20%, transparent);
}

.researcher-tab-btn-home.active::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    height: 4px;
    background: var(--color-primary);
    width: 0;
    animation: progressBar 4s linear forwards;
    z-index: 1;
    border-radius: 2px 2px 0 0;
}

@keyframes tabPulse {
    0%, 100% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.02);
    }
}

@keyframes progressBar {
    0% {
        width: 0;
        opacity: 1;
    }
    100% {
        width: 100%;
        opacity: 1;
    }
}

.researcher-tab-content-home {
    display: none;
}

.researcher-tab-content-home.active {
    display: block;
    animation: fadeInSlide 0.5s ease;
    position: relative;
}

@keyframes fadeInSlide {
    from {
        opacity: 0;
        transform: translateY(15px) scale(0.98);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Subtle pulse on content to indicate it will change */
.researcher-tab-content-home.active .top-researchers-grid-home {
    animation: contentPulse 4s ease-in-out infinite;
}

@keyframes contentPulse {
    0%, 90%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    95% {
        opacity: 0.95;
        transform: scale(0.998);
    }
}

/* Info Modal Styles */
.info-modal-home {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 10000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
}

.info-modal-home.active {
    display: flex;
}

.info-modal-content-home {
    background: var(--bg-primary);
    border: 2px solid var(--border-color);
    border-radius: 16px;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
}

.info-modal-header-home {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 2px solid var(--border-color);
}

.info-modal-header-home h3 {
    margin: 0;
    font-size: 1.5rem;
    color: var(--text-primary);
}

.info-modal-close-home {
    background: transparent;
    border: none;
    cursor: pointer;
    color: var(--text-secondary);
    padding: 0.5rem;
    border-radius: 8px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.info-modal-close-home:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
}

.info-modal-body-home {
    padding: 1.5rem;
    color: var(--text-primary);
    line-height: 1.6;
}

.info-modal-body-home p {
    margin: 0 0 1rem 0;
}

.info-modal-body-home ul {
    margin: 1rem 0;
    padding-left: 1.5rem;
}

.info-modal-body-home li {
    margin-bottom: 0.5rem;
}

@keyframes slideUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@media (max-width: 1024px) {
    .research-stats-with-chart {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .pie-chart-wrapper-home {
        position: static;
    }
    
    .stats-row-top-home {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .stats-row-bottom-home {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .research-stats-row {
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(2, minmax(150px, auto));
        gap: 1rem;
    }
    
    .stat-citations {
        grid-column: 1 / span 3;
        grid-row: 1 / span 2;
        padding: 2.5rem 2rem;
    }
    
    .stat-citations .stat-icon {
        font-size: 3.5rem;
    }
    
    .stat-citations .research-stat-value {
        font-size: 3rem;
    }
    
    .stat-publications {
        grid-column: 4 / span 3;
        grid-row: 1 / span 2;
        padding: 2rem 1.5rem;
    }
    
    .stat-publications .stat-icon {
        font-size: 3rem;
    }
    
    .stat-publications .research-stat-value {
        font-size: 2.5rem;
    }
    
    .stat-bottom:nth-of-type(3) {
        grid-column: 4 / span 2;
    }
    
    .stat-bottom:nth-of-type(4) {
        grid-column: 6 / span 1;
    }
    
    .stat-bottom:nth-of-type(5) {
        grid-column: 4 / span 3;
    }
    
    .top-researchers-grid-home {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.25rem;
    }
}

@media (max-width: 768px) {
    .research-home-section {
        padding: 2rem 0;
    }
    
    .research-home-header h2 {
        font-size: 1.75rem;
    }
    
    .research-stats-with-chart {
        grid-template-columns: 1fr;
        gap: 1.5rem;
        padding: 0 1rem;
    }
    
    .pie-chart-wrapper-home {
        position: static;
        height: auto;
        align-items: flex-start;
    }
    
    .chart-card-home {
        height: auto;
    }
    
    .stats-cards-wrapper-home {
        height: auto;
        gap: 1.25rem;
        justify-content: flex-start;
    }
    
    .stats-row-top-home {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
    }
    
    .stats-row-bottom-home {
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
    }
    
    .stat-large-home {
        padding: 1.5rem 1rem;
    }
    
    .stat-large-home .research-stat-value {
        font-size: 1.75rem;
    }
    
    .stat-compact-home {
        padding: 1.25rem 0.875rem;
    }
    
    .stat-compact-home .stat-icon {
        font-size: 1.25rem;
        margin-bottom: 0.4rem;
    }
    
    .stat-compact-home .research-stat-value {
        font-size: 1rem;
    }
    
    .stat-compact-home .research-stat-label {
        font-size: 0.5rem;
    }
    
    .chart-wrapper-home {
        min-height: 250px;
    }
    
    .research-stats-row {
        grid-template-columns: repeat(2, 1fr);
        grid-template-rows: auto;
        gap: 1rem;
        padding: 0 1rem;
    }
    
    .stat-citations {
        grid-column: span 2;
        grid-row: auto;
        padding: 2rem 1.5rem;
    }
    
    .stat-citations .stat-icon {
        font-size: 3rem;
    }
    
    .stat-citations .research-stat-value {
        font-size: 2.5rem;
    }
    
    .stat-publications {
        grid-column: span 2;
        grid-row: auto;
        padding: 1.75rem 1.5rem;
    }
    
    .stat-publications .stat-icon {
        font-size: 2.5rem;
    }
    
    .stat-publications .research-stat-value {
        font-size: 2rem;
    }
    
    .stat-bottom {
        grid-column: span 2;
        grid-row: auto;
        padding: 1.5rem 1.25rem;
    }
    
    .stat-bottom:nth-of-type(3),
    .stat-bottom:nth-of-type(4),
    .stat-bottom:nth-of-type(5) {
        grid-column: span 2;
    }
    
    .research-stat-value {
        font-size: 1.5rem;
    }
    
    .stat-icon {
        font-size: 1.5rem;
    }
    
    .top-researchers-title {
        font-size: 1.25rem;
        margin-bottom: 1.5rem;
    }
    
    .top-researchers-grid-home {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        padding: 0 1rem;
    }
}

@media (max-width: 480px) {
    .research-home-section {
        padding: 1.25rem 0;
    }
    
    .research-home-header h2 {
        font-size: 1.35rem;
    }
    
    .research-stats-row {
        grid-template-columns: 1fr;
        grid-template-rows: auto;
        gap: 0.75rem;
        padding: 0 1rem;
    }
    
    .stat-citations,
    .stat-publications,
    .stat-bottom {
        grid-column: span 1;
        grid-row: auto;
    }
    
    .stat-citations {
        padding: 1.75rem 1.5rem;
    }
    
    .stat-citations .stat-icon {
        font-size: 2.5rem;
    }
    
    .stat-citations .research-stat-value {
        font-size: 2rem;
    }
    
    .stat-publications {
        padding: 1.5rem 1.25rem;
    }
    
    .stat-publications .stat-icon {
        font-size: 2rem;
    }
    
    .stat-publications .research-stat-value {
        font-size: 1.75rem;
    }
    
    .stat-bottom {
        padding: 1.25rem 1rem;
    }
    
    .stat-bottom:nth-of-type(3),
    .stat-bottom:nth-of-type(4),
    .stat-bottom:nth-of-type(5) {
        grid-column: span 1;
    }
    
    .research-stat-value {
        font-size: 1.25rem;
    }
    
    .stat-icon {
        font-size: 1.25rem;
    }
    
    .top-researchers-header {
        margin-bottom: 0.875rem;
    }
    
    .top-researchers-title {
        font-size: 1rem;
    }
    
    .top-researchers-grid-home {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.5rem;
        padding: 0 1rem;
    }
    
    .top-researcher-card-home {
        gap: 0.5rem;
    }
    
    .researcher-card-home-image {
        max-width: 100%;
        margin: 0;
        border-radius: 8px;
        max-height: 210px;
        min-height: clamp(110px, 15vw, 140px);
        aspect-ratio: 3 / 4;
    }
    
    .researcher-card-home-overlay {
        padding: 0.625rem 0.5rem 0.5rem 0.5rem;
    }
    
    .researcher-card-home-info {
        gap: 0.25rem;
    }
    
    .researcher-name-home {
        font-size: 0.55rem;
        line-height: 1.1;
    }
    
    .researcher-meta-home {
        gap: 0.25rem;
        font-size: 0.45rem;
    }
    
    .researcher-score-home,
    .researcher-pubs-home,
    .researcher-citation-home {
        font-size: 0.425rem;
    }
    
    .researcher-designation-home {
        font-size: 0.375rem;
        padding: 0.25rem 0.375rem;
    }
    
    .info-modal-content-home {
        width: 95%;
    }
    
    .info-modal-header-home {
        padding: 1rem;
    }
    
    .info-modal-header-home h3 {
        font-size: 1.1rem;
    }
    
    .info-modal-body-home {
        padding: 1rem;
        font-size: 0.9rem;
    }
}

@media (max-width: 767px) {
    .hod-card {
        padding: 1.35rem;
    }
    .hod-avatar {
        width: 74px;
        height: 74px;
    }
    .hod-title-row h2 {
        font-size: 1.4rem;
    }
}

.mapping-legend {
    display: flex;
    gap: 1rem;
    align-items: center;
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.legend-dot {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 999px;
    margin-right: 0.35rem;
}

.legend-dot.primary { background: var(--color-primary); }
.legend-dot.soft { background: var(--bg-tertiary); border: 1px solid var(--border-color); }

.mapping-table {
    display: grid;
    grid-template-columns: 1fr repeat(4, 110px);
    overflow: auto;
}

.mapping-row {
    display: contents;
}

.cell {
    padding: 0.85rem;
    border: 1px solid var(--border-color);
    background: var(--bg-secondary);
    text-align: center;
    font-size: 0.95rem;
    color: var(--text-primary);
}

.cell.head {
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));
    color: white;
    font-weight: 700;
    letter-spacing: 0.02em;
}

.cell.label {
    text-align: left;
    font-weight: 700;
    color: var(--text-primary);
    background: var(--bg-secondary);
}

.cell.mark {
    color: var(--text-primary);
    font-weight: 800;
    background: var(--bg-secondary);
}

.cell.mark.strong {
    background: color-mix(in srgb, var(--color-primary) 15%, var(--bg-secondary));
    color: var(--color-primary);
}

.cell.mark.soft {
    background: color-mix(in srgb, var(--color-primary) 8%, var(--bg-secondary));
    color: var(--text-primary);
}

@media (max-width: 992px) {
    .mvpeo-header {
        flex-direction: column;
        align-items: flex-start;
    }
    .mapping-table {
        grid-template-columns: 1fr repeat(4, 90px);
    }
}

@media (max-width: 767px) {
    .mvpeo-section {
        padding: 2.25rem 0 1.5rem;
    }
    .mvpeo-header h2 {
        font-size: 1.65rem;
    }
    .card-grid.three,
    .card-grid.four {
        grid-template-columns: 1fr;
    }
    .mapping-table {
        grid-template-columns: 1fr repeat(4, 80px);
    }
}

/* Post Modal Styles - Almost Full Page */
.post-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    z-index: 10000;
    backdrop-filter: blur(4px);
    animation: fadeIn 0.3s ease;
    overflow-y: auto;
}

.post-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
}

.post-modal-content {
    background: var(--bg-primary);
    border-radius: 16px;
    width: 100%;
    max-width: 800px;
    max-height: 95vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    animation: slideUp 0.3s ease;
    position: relative;
}

.post-modal-header {
    padding: 1.25rem 2rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--bg-secondary);
    border-radius: 16px 16px 0 0;
    position: sticky;
    top: 0;
    z-index: 10;
}

.post-modal-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.post-modal-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.post-modal-action-btn {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    padding: 0.5rem 0.9rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    color: var(--text-primary);
    font-size: 0.875rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}

.post-modal-action-btn:hover {
    background: var(--bg-tertiary);
    border-color: var(--color-primary);
    color: var(--color-primary);
    transform: translateY(-1px);
}

.post-modal-action-btn svg {
    flex-shrink: 0;
}

.post-modal-action-btn span {
    white-space: nowrap;
}

.post-modal-close {
    background: var(--bg-tertiary);
    border: 2px solid var(--border-color);
    border-radius: 10px;
    padding: 0.5rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.post-modal-close:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
    transform: translateY(-2px);
}

.post-modal-body {
    padding: 2rem;
}

.post-modal-meta {
    display: flex;
    gap: 1rem;
    align-items: center;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
}

.post-modal-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.4rem 0.85rem;
    border-radius: 8px;
    font-size: 0.85rem;
    font-weight: 600;
    text-transform: uppercase;
}

.post-modal-date {
    font-size: 0.9rem;
    color: var(--text-secondary);
}

.post-modal-full-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 1rem 0;
    line-height: 1.3;
}

.post-modal-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
}

.post-modal-tags .tag {
    padding: 0.35rem 0.75rem;
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.post-modal-description {
    color: var(--text-primary);
    line-height: 1.8;
    font-size: 1rem;
}

.post-modal-description img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 1rem 0;
}

.post-modal-thumbnail-container {
    margin-bottom: 2rem;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    background: transparent;
}

.post-modal-thumbnail {
    max-width: 100%;
    height: auto;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    object-fit: contain;
    display: block;
}

.post-modal-thumbnail-container img.post-modal-thumbnail {
    width: auto;
    max-width: 100%;
    max-height: 400px;
}

@media (max-width: 768px) {
    .post-modal-content {
        max-width: 95vw;
    }
    
    .post-modal-body {
        padding: 1.5rem;
    }

    .post-modal-title {
        display: none;
    }
}

@media (max-width: 480px) {
    .post-modal-content {
        max-width: 95vw;
        border-radius: 12px;
    }
    
    .post-modal-body {
        padding: 1rem;
    }
    
    .post-modal-full-title {
        font-size: 1.25rem;
    }

    .post-modal-title {
        display: none;
    }
}

@keyframes slideUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

/* PO Stats Section Styles */
.po-stats-section {
    scroll-margin-top: 2rem;
}

.po-stats-tables {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
}

.stats-table-wrapper {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    overflow: hidden; /* DESKTOP: prevent scroll */
}

.stats-table-wrapper:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px var(--shadow-lg) !important;
}

.stats-table {
    width: 100%; /* DESKTOP: full width */
    border-collapse: collapse;
    font-size: 0.95rem;
    table-layout: auto; /* DESKTOP: automatic column widths */
}

.stats-table th,
.stats-table td {
    padding: 1rem;
    text-align: left;
}

.stats-table tbody tr:hover {
    background: color-mix(in srgb, var(--color-primary) 5%, var(--bg-secondary));
}

/* Blooms Cards Container */
.blooms-cards-container {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* 3 cards side by side */
    gap: 1rem;
}
@media (max-width: 768px) {
    .blooms-cards-container {
        grid-template-columns: 1fr; /* stack on mobile */
        gap: 1rem;
    }
}
.stats-table-wrapper.blooms-card {
    background: var(--bg-primary);
    border: 1px solid var(--border-color);
    border-radius: 16px;
    padding: 1rem;
    box-shadow: 0 4px 12px var(--shadow);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.stats-table-wrapper.blooms-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px var(--shadow-lg);
}

.stats-table-wrapper h4 {
    margin: 0 0 0.75rem 0;
    color: var(--color-primary);
    font-size: 0.95rem;
    font-weight: 700;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid var(--color-primary);
}


/* PO Stats Header */
.po-stats-header h2 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.po-stats-header .subtitle {
    font-size: 1rem;
    color: var(--text-secondary);
}

/* MOBILE SCROLL */
@media (max-width: 768px) {

    .po-stats-tables {
        grid-template-columns: 1fr !important;
        gap: 1.5rem !important;
    }

    .blooms-cards-container {
        grid-template-columns: 1fr !important;
        gap: 1rem !important;
    }


.stats-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.85rem;
}

.stats-table th,
.stats-table td {
    padding: 0.4rem;
    font-size: 0.75rem;
    border-bottom: 1px solid var(--border-color);
}

.stats-table th {
    text-align: center;
    font-weight: 600;
    color: var(--text-primary);
    background: color-mix(in srgb, var(--color-primary) 10%, var(--bg-secondary));
}

.stats-table td:first-child {
    text-align: left;
    color: var(--text-primary);
}

.stats-table td:not(:first-child) {
    text-align: center;
    color: var(--text-secondary);
}

.stats-table td:last-child {
    color: var(--color-primary);
    font-weight: 600;
}
@media (max-width: 768px) {
    .stats-table-wrapper {
        overflow-x: auto;
    }
    .stats-table {
        min-width: 400px; /* scroll horizontally if needed */
    }
}

    .po-stats-header h2 {
        font-size: 1.5rem !important;
    }

    .po-stats-header .subtitle {
        font-size: 0.9rem !important;
    }
}

@media (max-width: 480px) {
    .po-stats-section {
        padding: 1rem 0.5rem;
    }

    .po-stats-header h2 {
        font-size: 1.25rem !important;
    }

    .po-stats-header .subtitle {
        font-size: 0.85rem !important;
    }
}

/* Gallery Showcase Styles */
.gallery-showcase-section {
    padding: 3rem 0;
    background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
    position: relative;
    overflow: hidden;
}

.gallery-showcase-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 50%, color-mix(in srgb, var(--color-primary) 5%, transparent) 0%, transparent 50%);
    pointer-events: none;
}

.gallery-showcase-container {
    position: relative;
    z-index: 1;
}

.gallery-showcase-header {
    text-align: center;
    margin-bottom: 1.5rem;
}

.gallery-showcase-header .eyebrow {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--color-primary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: 0.5rem;
}

.gallery-showcase-header h2 {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0.25rem 0;
}

.gallery-showcase-header .subtitle {
    font-size: 1.125rem;
    color: var(--text-secondary);
    margin-top: 0.25rem;
}

.gallery-showcase-footer {
    display: flex;
    justify-content: center;
    margin-top: 1rem;
    padding-top: 1rem;
}

.gallery-browse-all-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    background: var(--color-primary);
    color: white;
    text-decoration: none;
    border-radius: 12px;
    font-weight: 600;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px color-mix(in srgb, var(--color-primary) 30%, transparent);
}

.gallery-browse-all-btn:hover {
    background: var(--color-primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px color-mix(in srgb, var(--color-primary) 40%, transparent);
}

.gallery-browse-all-btn svg {
    transition: transform 0.3s ease;
}

.gallery-browse-all-btn:hover svg {
    transform: translateX(4px);
}

.gallery-stack-wrapper {
    position: relative;
    padding: 2rem 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 500px;
}

.gallery-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 44px;
    height: 44px;
    border-radius: 999px;
    border: none;
    background: rgba(0, 0, 0, 0.5);
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 20;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
    transition: all 0.25s ease;
}

.gallery-nav-btn svg {
    pointer-events: none;
}

.gallery-nav-btn:hover {
    background: rgba(0, 0, 0, 0.8);
    transform: translateY(-50%) scale(1.05);
}

.gallery-nav-left {
    left: 4%;
}

.gallery-nav-right {
    right: 4%;
}

.gallery-stack {
    position: relative;
    width: 100%;
    max-width: 1200px;
    height: 500px;
    margin: 0 auto;
    perspective: 2000px;
}

.gallery-stack-card {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 1000px;
    height: 100%;
    cursor: pointer;
    transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    transform-origin: center center;
}

.gallery-stack-card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
    background: var(--bg-secondary);
    transform-style: preserve-3d;
    transition: transform 0.3s ease;
}

.gallery-stack-card:hover .gallery-stack-card-inner {
    transform: translateY(-10px) scale(1.02);
}

.gallery-stack-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.gallery-stack-card-overlay {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.4) 70%, transparent 100%);
    padding: 0.6rem 1.4rem;
    color: white;
    opacity: 1;
    transition: all 0.25s ease;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
}

.gallery-stack-card-overlay h3 {
    font-size: 1rem;
    font-weight: 600;
    margin: 0;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.9);
    color: white;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 100%;
}

.gallery-stack-card-overlay p {
    font-size: 0.9rem;
    margin: 0.5rem 0 0 0;
    opacity: 0;
    max-height: 0;
    overflow: hidden;
    text-shadow: 0 1px 6px rgba(0, 0, 0, 0.9);
    color: white;
    transition: opacity 0.25s ease, max-height 0.25s ease, margin 0.25s ease;
}

.gallery-stack-card:hover .gallery-stack-card-overlay {
    padding-bottom: 1.2rem;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.98) 0%, rgba(0, 0, 0, 0.7) 60%, transparent 100%);
}

.gallery-stack-card:hover .gallery-stack-card-overlay p {
    opacity: 1;
    max-height: 160px;
    margin-top: 0.6rem;
}

/* Card stacking positions - showing cards behind */
.gallery-stack-card[data-index="0"] {
    z-index: 10;
    transform: translateX(-50%) scale(1);
    opacity: 1;
}

.gallery-stack-card[data-index="1"] {
    z-index: 9;
    transform: translateX(-50%) translateX(30px) translateY(20px) scale(0.95);
    opacity: 0.85;
    filter: blur(1px);
}

.gallery-stack-card[data-index="2"] {
    z-index: 8;
    transform: translateX(-50%) translateX(60px) translateY(40px) scale(0.9);
    opacity: 0.7;
    filter: blur(2px);
}

.gallery-stack-card[data-index="3"] {
    z-index: 7;
    transform: translateX(-50%) translateX(90px) translateY(60px) scale(0.85);
    opacity: 0.55;
    filter: blur(3px);
}

.gallery-stack-card[data-index="4"] {
    z-index: 6;
    transform: translateX(-50%) translateX(120px) translateY(80px) scale(0.8);
    opacity: 0.4;
    filter: blur(4px);
}

/* Hide cards beyond index 4 */
.gallery-stack-card[data-index]:not([data-index="0"]):not([data-index="1"]):not([data-index="2"]):not([data-index="3"]):not([data-index="4"]) {
    opacity: 0;
    pointer-events: none;
}

.gallery-dots {
    display: flex;
    justify-content: center;
    gap: 0.75rem;
    margin-top: 2rem;
    flex-wrap: wrap;
}

.gallery-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: none;
    background: color-mix(in srgb, var(--color-primary) 30%, transparent);
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 0;
}

.gallery-dot:hover {
    background: color-mix(in srgb, var(--color-primary) 60%, transparent);
    transform: scale(1.2);
}

.gallery-dot.active {
    background: var(--color-primary);
    width: 32px;
    border-radius: 6px;
    box-shadow: 0 0 12px color-mix(in srgb, var(--color-primary) 50%, transparent);
}

/* Gallery Modal */
.gallery-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 10000;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.gallery-modal.active {
    display: flex;
    opacity: 1;
}

.gallery-modal-content {
    position: relative;
    max-width: 1200px;
    width: 100%;
    max-height: 90vh;
    background: var(--bg-secondary);
    border-radius: 24px;
    overflow: hidden;
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.5);
    transform: scale(0.9);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.gallery-modal.active .gallery-modal-content {
    transform: scale(1);
}

.gallery-modal-close {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    border: none;
    background: rgba(255, 255, 255, 0.1);
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10001;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.gallery-modal-close:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: rotate(90deg);
}

.gallery-modal-body {
    padding: 3rem;
    overflow-y: auto;
    max-height: calc(90vh - 6rem);
}

.gallery-modal-image {
    width: 100%;
    border-radius: 16px;
    margin-bottom: 2rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}

.gallery-modal-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.gallery-modal-description {
    font-size: 1.125rem;
    color: var(--text-secondary);
    line-height: 1.7;
}

@media (max-width: 768px) {
    .gallery-stack {
        height: 400px;
    }
    
    .gallery-stack-wrapper {
        min-height: 450px;
        padding: 2rem 0;
    }
    
    .gallery-stack-card {
        width: 95%;
    }
    
    .gallery-stack-card-overlay {
        padding: 1.5rem 1rem;
    }
    
    .gallery-stack-card:hover .gallery-stack-card-overlay {
        padding: 2rem 1rem;
    }
    
    .gallery-stack-card-overlay h3 {
        font-size: 1.25rem;
    }
    
    .gallery-stack-card-overlay p {
        font-size: 0.9rem;
    }
    
    .gallery-showcase-header h2 {
        font-size: 2rem;
    }
    
    .gallery-browse-all-btn {
        padding: 0.625rem 1.25rem;
        font-size: 0.9rem;
    }
    
    .gallery-modal-body {
        padding: 2rem 1.5rem;
    }
    
    .gallery-modal-title {
        font-size: 1.5rem;
    }
    
    /* Adjust card positions for mobile */
    .gallery-stack-card[data-index="1"] {
        transform: translateX(-50%) translateX(20px) translateY(15px) scale(0.95);
    }
    
    .gallery-stack-card[data-index="2"] {
        transform: translateX(-50%) translateX(40px) translateY(30px) scale(0.9);
    }
    
    .gallery-stack-card[data-index="3"] {
        transform: translateX(-50%) translateX(60px) translateY(45px) scale(0.85);
    }
    
    .gallery-stack-card[data-index="4"] {
        transform: translateX(-50%) translateX(80px) translateY(60px) scale(0.8);
    }
}


</style>

{% endblock %}

{% block extra_js %}

<script>
document.addEventListener("DOMContentLoaded", function() {
    const banner = document.getElementById("marks-banner");
    const section = document.getElementById("marks-distribution-section");

    if (banner && section) {
        banner.addEventListener("click", function() {
            const offset = 80;
            const y = section.getBoundingClientRect().top + window.scrollY - offset;
            window.scrollTo({ top: y, behavior: "smooth" });
        });
    }
});


// Top Researchers Info Modal
document.addEventListener('DOMContentLoaded', function() {
    const infoBtn = document.getElementById('top-researchers-info-btn');
    const infoModal = document.getElementById('top-researchers-info-modal');
    const closeModal = document.getElementById('close-top-researchers-info-modal');
    
    if (infoBtn && infoModal) {
        infoBtn.addEventListener('click', function() {
            infoModal.classList.add('active');
        });
    }
    
    if (closeModal && infoModal) {
        closeModal.addEventListener('click', function() {
            infoModal.classList.remove('active');
        });
    }
    
    // Close modal when clicking outside
    if (infoModal) {
        infoModal.addEventListener('click', function(e) {
            if (e.target === infoModal) {
                infoModal.classList.remove('active');
            }
        });
    }
    
    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && infoModal && infoModal.classList.contains('active')) {
            infoModal.classList.remove('active');
        }
    });
});

// Tab Info Modal Functions
function openTabInfoModal(tabName) {
    const modal = document.getElementById(tabName + '-info-modal');
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

function closeTabInfoModal(tabName) {
    const modal = document.getElementById(tabName + '-info-modal');
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
    }
}

// Close tab info modals on background click
document.addEventListener('click', function(e) {
    const modals = ['most-cited-info-modal', 'leading-active-info-modal', 'top-designation-info-modal'];
    modals.forEach(modalId => {
        const modal = document.getElementById(modalId);
        if (modal && e.target === modal) {
            modal.classList.remove('active');
            document.body.style.overflow = '';
        }
    });
});

// Close tab info modals on Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const modals = ['most-cited-info-modal', 'leading-active-info-modal', 'top-designation-info-modal'];
        modals.forEach(modalId => {
            const modal = document.getElementById(modalId);
            if (modal && modal.classList.contains('active')) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        });
    }
});
    
    // Count-up animation for research stats
document.addEventListener("DOMContentLoaded", function() {

    // Count-up animation for research stats
    function animateValue(element, start, end, duration, isDecimal, decimalPlaces) {
        const startTime = performance.now();
        const isFloat = isDecimal || end.toString().includes('.');

        function update(currentTime) {
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);

            const easeOutQuart = 1 - Math.pow(1 - progress, 4);
            const current = start + (end - start) * easeOutQuart;

            if (isFloat) {
                const places = decimalPlaces || 2;
                element.textContent = current.toFixed(places);
            } else {
                element.textContent = Math.floor(current).toLocaleString();
            }

            if (progress < 1) {
                requestAnimationFrame(update);
            } else {
                if (isFloat) {
                    const places = decimalPlaces || 2;
                    element.textContent = parseFloat(end).toFixed(places);
                } else {
                    element.textContent = parseInt(end).toLocaleString();
                }
            }
        }

        requestAnimationFrame(update);
    }

    // Intersection Observer
    const statsSection = document.querySelector('.research-home-section');
    if (statsSection) {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const statValues = entry.target.querySelectorAll('.research-stat-value[data-target]');
                    statValues.forEach(stat => {
                        if (!stat.classList.contains('animated')) {
                            stat.classList.add('animated');
                            const target = parseFloat(stat.getAttribute('data-target'));
                            const isDecimal = stat.getAttribute('data-is-decimal') === 'true';
                            const decimalPlaces = parseInt(stat.getAttribute('data-decimal-places')) || 2;
                            const duration = 2000; // 2 seconds

                            animateValue(stat, 0, target, duration, isDecimal, decimalPlaces);
                        }
                    });
                    observer.unobserve(entry.target);
                }
            });
        }, {
            threshold: 0.3,
            rootMargin: '0px 0px -50px 0px'
        });

        observer.observe(statsSection);
    }

}); // End of DOMContentLoaded

// Pass hero tags from Django to JavaScript
const heroTagsData = [
    {% for tag in hero_tags %}
    '{{ tag.title }}'{% if not forloop.last %},{% endif %}
    {% endfor %}
];

// UAP Now Post Modal Functionality
const uapNowPostsData = {
    {% for post_item in uap_now_posts %}
    {% if post_item.type == 'post' %}
    'post_{{ post_item.object.pk }}': {
        'type': 'post',
        'post_type': '{{ post_item.object.post_type }}',
        'post_type_display': '{{ post_item.object.get_post_type_display|escapejs }}',
        'short_title': '{{ post_item.object.short_title|escapejs }}',
        'long_title': '{{ post_item.object.long_title|escapejs }}',
        'description': `{{ post_item.object.description|safe }}`,
        'tags': '{{ post_item.object.tags|default:""|escapejs }}',
        'date': '{{ post_item.object.publish_date|date:"F d, Y" }}',
        'is_pinned': {{ post_item.object.is_pinned|yesno:"true,false" }},
        'club_name': null,
        'club_id': null,
        'thumbnail': {% if post_item.object.thumbnail %}'{{ post_item.object.thumbnail.url|escapejs }}'{% else %}null{% endif %}
    }{% if not forloop.last %},{% endif %}
    {% else %}
    'club_post_{{ post_item.object.pk }}': {
        'type': 'club_post',
        'post_type': '{{ post_item.object.post_type }}',
        'post_type_display': '{{ post_item.object.get_post_type_display|escapejs }}',
        'short_title': '{{ post_item.object.short_title|escapejs }}',
        'long_title': '{{ post_item.object.long_title|escapejs }}',
        'description': `{{ post_item.object.description|safe }}`,
        'tags': '{{ post_item.object.tags|default:""|escapejs }}',
        'date': '{{ post_item.object.created_at|date:"F d, Y" }}',
        'is_pinned': {{ post_item.object.is_pinned|yesno:"true,false" }},
        'club_name': '{{ post_item.object.club.short_name|default:post_item.object.club.name|escapejs }}',
        'club_id': {{ post_item.object.club.pk }}
    }{% if not forloop.last %},{% endif %}
    {% endif %}
    {% endfor %}
};

// Store current UAP Now post info for sharing
let currentUapNowPostType = null;
let currentUapNowPostId = null;

function openUapNowModal(postType, postId) {
    const key = postType + '_' + postId;
    const post = uapNowPostsData[key];
    if (!post) {
        console.error('Post not found:', key);
        return;
    }
    
    // Store post info for sharing
    currentUapNowPostType = postType;
    currentUapNowPostId = postId;
    
    const modal = document.getElementById('uapNowModal');
    
    // Show/hide Open button based on post type (only show for regular posts)
    const openBtn = document.getElementById('uapNowModalOpenBtn');
    if (openBtn) {
        openBtn.style.display = postType === 'post' ? 'flex' : 'none';
    }
    
    // Set modal content
    document.getElementById('uapNowModalBadge').textContent = post.post_type_display;
    document.getElementById('uapNowModalBadge').className = 'post-modal-badge uapnow-badge-' + post.post_type + (post.is_pinned ? ' pinned' : '');
    document.getElementById('uapNowModalDate').textContent = post.date;
    
    // Thumbnail (if modal has thumbnail support)
    const thumbnailContainer = document.getElementById('uapNowModalThumbnail');
    const thumbnailImg = document.getElementById('uapNowModalThumbnailImg');
    if (thumbnailContainer && thumbnailImg && post.thumbnail) {
        thumbnailImg.src = post.thumbnail;
        thumbnailImg.alt = post.short_title;
        thumbnailContainer.style.display = 'flex';
    } else if (thumbnailContainer) {
        thumbnailContainer.style.display = 'none';
    }
    
    // Title with club name if applicable
    let titleText = post.long_title;
    if (post.club_name) {
        titleText += ' <span style="font-size: 0.8em; color: var(--text-secondary);"> - ' + post.club_name + '</span>';
    }
    document.getElementById('uapNowModalFullTitle').innerHTML = titleText;
    
    // Tags
    const tagsContainer = document.getElementById('uapNowModalTags');
    tagsContainer.innerHTML = '';
    if (post.tags) {
        const tags = post.tags.split(',').map(t => t.trim()).filter(t => t);
        tags.forEach(tag => {
            const tagSpan = document.createElement('span');
            tagSpan.className = 'tag';
            tagSpan.textContent = tag;
            tagsContainer.appendChild(tagSpan);
        });
    }
    
    // Description
    document.getElementById('uapNowModalDescription').innerHTML = post.description;
    
    // Show modal
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeUapNowModal() {
    const modal = document.getElementById('uapNowModal');
    modal.classList.remove('active');
    document.body.style.overflow = '';
}

// Close modal on background click
document.addEventListener('click', function(e) {
    const modal = document.getElementById('uapNowModal');
    if (e.target === modal) {
        closeUapNowModal();
    }
});

// Close modal on Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const modal = document.getElementById('uapNowModal');
        if (modal.classList.contains('active')) {
            closeUapNowModal();
        }
    }
});

// Open UAP Now post detail page
function openUapNowPostDetail() {
    if (currentUapNowPostType === 'post' && currentUapNowPostId) {
        const url = "{% url 'office:post_detail' 0 %}".replace('0', currentUapNowPostId);
        window.location.href = url;
    }
}

// Copy UAP Now post link to clipboard
function copyUapNowPostLink() {
    if (!currentUapNowPostType || !currentUapNowPostId) {
        return;
    }
    
    let url;
    if (currentUapNowPostType === 'post') {
        url = "{% url 'office:post_detail' 0 %}".replace('0', currentUapNowPostId);
    } else {
        // For club posts, use the current page URL with a hash or parameter
        url = window.location.origin + window.location.pathname + '?post=' + currentUapNowPostId;
    }
    
    // Make it a full URL
    if (!url.startsWith('http')) {
        url = window.location.origin + url;
    }
    
    // Copy to clipboard
    navigator.clipboard.writeText(url).then(function() {
        // Show feedback
        const copyBtn = document.getElementById('uapNowModalCopyBtn');
        const originalText = copyBtn.querySelector('span').textContent;
        copyBtn.querySelector('span').textContent = 'Copied!';
        copyBtn.style.color = 'var(--color-primary)';
        
        setTimeout(function() {
            copyBtn.querySelector('span').textContent = originalText;
            copyBtn.style.color = '';
        }, 2000);
    }).catch(function(err) {
        console.error('Failed to copy link:', err);
        // Fallback: select text in a temporary input
        const tempInput = document.createElement('input');
        tempInput.value = url;
        document.body.appendChild(tempInput);
        tempInput.select();
        document.execCommand('copy');
        document.body.removeChild(tempInput);
        
        const copyBtn = document.getElementById('uapNowModalCopyBtn');
        const originalText = copyBtn.querySelector('span').textContent;
        copyBtn.querySelector('span').textContent = 'Copied!';
        setTimeout(function() {
            copyBtn.querySelector('span').textContent = originalText;
        }, 2000);
    });
}

// ========== UAP CSE Now Dynamic Carousel ==========
document.addEventListener('DOMContentLoaded', function() {
    const grid = document.getElementById('uapnowGrid');
    const indicator = document.getElementById('uapnowIndicator');
    const statusText = document.getElementById('uapnowStatus');
    const pauseBtn = document.getElementById('uapnowPauseBtn');
    const prevBtn = document.getElementById('uapnowPrev');
    const nextBtn = document.getElementById('uapnowNext');
    const controls = document.getElementById('uapnowCarouselControls');
    
    if (!grid) return;
    
    // Get all cards
    const allCards = Array.from(grid.querySelectorAll('.uapnow-card'));
    const pinnedCards = allCards.filter(c => c.dataset.pinned === 'true');
    const nonPinnedCards = allCards.filter(c => c.dataset.pinned === 'false');
    
    
    // If no non-pinned cards or only one, hide controls
    if (nonPinnedCards.length <= 1) {
        if (controls) controls.style.display = 'none';
        return;
    }
    
    // Configuration
    const ROTATE_INTERVAL = 4000; // 4 seconds
    const SLOTS = Math.min(3, nonPinnedCards.length); // Show max 3 non-pinned cards at a time
    
    let currentIndex = 0;
    let isPaused = false;
    let rotateTimer = null;
    let visibleNonPinned = [];
    
    // Initialize visible cards
    function initializeCarousel() {
        // Hide all non-pinned cards first
        nonPinnedCards.forEach((card, i) => {
            card.classList.add('carousel-hidden');
            card.classList.remove('timer-active', 'about-to-leave', 'leaving', 'entering');
        });
        
        // Show first SLOTS cards
        visibleNonPinned = [];
        for (let i = 0; i < SLOTS && i < nonPinnedCards.length; i++) {
            const card = nonPinnedCards[i];
            card.classList.remove('carousel-hidden');
            visibleNonPinned.push(card);
        }
        
        currentIndex = SLOTS - 1; // Index of oldest visible card
        
        // Generate indicator dots
        generateIndicatorDots();
        
        // Start the timer on the oldest visible card
        startTimerOnOldest();
    }
    
    // Generate indicator dots
    function generateIndicatorDots() {
        if (!indicator) return;
        indicator.innerHTML = '';
        
        for (let i = 0; i < nonPinnedCards.length; i++) {
            const dot = document.createElement('div');
            dot.className = 'uapnow-carousel-dot';
            if (i < SLOTS) dot.classList.add('active');
            dot.dataset.index = i;
            dot.addEventListener('click', () => goToCard(i));
            indicator.appendChild(dot);
        }
    }
    
    // Update indicator dots
    function updateIndicatorDots() {
        if (!indicator) return;
        const dots = indicator.querySelectorAll('.uapnow-carousel-dot');
        dots.forEach((dot, i) => {
            const card = nonPinnedCards[i];
            dot.classList.toggle('active', !card.classList.contains('carousel-hidden'));
        });
    }
    
    // Start timer animation on the oldest visible card (first to leave)
    function startTimerOnOldest() {
        // Remove timer from all cards
        nonPinnedCards.forEach(c => c.classList.remove('timer-active'));
        
        // The oldest visible is the first one in visibleNonPinned
        if (visibleNonPinned.length > 0 && !isPaused) {
            visibleNonPinned[0].classList.add('timer-active');
        }
    }
    
    // Rotate to next card
    function rotateNext() {
        if (isPaused || visibleNonPinned.length === 0) return;
        
        // Get the card that will leave (oldest visible)
        const leavingCard = visibleNonPinned[0];
        
        // Get the next card to enter
        const nextIndex = (nonPinnedCards.indexOf(visibleNonPinned[visibleNonPinned.length - 1]) + 1) % nonPinnedCards.length;
        const enteringCard = nonPinnedCards[nextIndex];
        
        // Don't rotate if entering card is already visible
        if (visibleNonPinned.includes(enteringCard)) {
            // All cards are visible, just restart timer
            startRotation();
            return;
        }
        
        // Animate the leaving card
        leavingCard.classList.remove('timer-active');
        leavingCard.classList.add('about-to-leave');
        
        setTimeout(() => {
            leavingCard.classList.remove('about-to-leave');
            leavingCard.classList.add('leaving');
            
            setTimeout(() => {
                // Hide the leaving card
                leavingCard.classList.remove('leaving');
                leavingCard.classList.add('carousel-hidden');
                
                // Remove from visible array
                visibleNonPinned.shift();
                
                // Show the entering card
                enteringCard.classList.remove('carousel-hidden');
                enteringCard.classList.add('entering');
                visibleNonPinned.push(enteringCard);
                
                setTimeout(() => {
                    enteringCard.classList.remove('entering');
                    
                    // Update indicator
                    updateIndicatorDots();
                    
                    // Start timer on new oldest
                    startTimerOnOldest();
                    
                    // Continue rotation
                    startRotation();
                }, 700);
            }, 600);
        }, 800);
    }
    
    // Rotate to previous card
    function rotatePrev() {
        if (visibleNonPinned.length === 0) return;
        
        stopRotation();
        
        // Get the card that will leave (newest visible)
        const leavingCard = visibleNonPinned[visibleNonPinned.length - 1];
        
        // Get the previous card to enter
        let prevIndex = nonPinnedCards.indexOf(visibleNonPinned[0]) - 1;
        if (prevIndex < 0) prevIndex = nonPinnedCards.length - 1;
        const enteringCard = nonPinnedCards[prevIndex];
        
        // Don't rotate if entering card is already visible
        if (visibleNonPinned.includes(enteringCard)) {
            startRotation();
            return;
        }
        
        // Quick transition for manual navigation
        leavingCard.classList.add('leaving');
        
        setTimeout(() => {
            leavingCard.classList.remove('leaving');
            leavingCard.classList.add('carousel-hidden');
            visibleNonPinned.pop();
            
            enteringCard.classList.remove('carousel-hidden');
            enteringCard.classList.add('entering');
            visibleNonPinned.unshift(enteringCard);
            
            setTimeout(() => {
                enteringCard.classList.remove('entering');
                updateIndicatorDots();
                startTimerOnOldest();
                if (!isPaused) startRotation();
            }, 700);
        }, 600);
    }
    
    // Go to specific card
    function goToCard(index) {
        stopRotation();
        
        const targetCard = nonPinnedCards[index];
        if (!targetCard || visibleNonPinned.includes(targetCard)) {
            if (!isPaused) startRotation();
            return;
        }
        
        // Hide all current visible
        visibleNonPinned.forEach(card => {
            card.classList.add('carousel-hidden');
            card.classList.remove('timer-active', 'about-to-leave');
        });
        
        // Show cards starting from clicked index
        visibleNonPinned = [];
        for (let i = 0; i < SLOTS; i++) {
            const idx = (index - i + nonPinnedCards.length) % nonPinnedCards.length;
            const card = nonPinnedCards[idx];
            card.classList.remove('carousel-hidden');
            card.classList.add('entering');
            visibleNonPinned.unshift(card);
        }
        
        setTimeout(() => {
            visibleNonPinned.forEach(c => c.classList.remove('entering'));
            updateIndicatorDots();
            startTimerOnOldest();
            if (!isPaused) startRotation();
        }, 700);
    }
    
    // Start rotation timer
    function startRotation() {
        stopRotation();
        if (!isPaused) {
            rotateTimer = setTimeout(rotateNext, ROTATE_INTERVAL);
        }
    }
    
    // Stop rotation timer
    function stopRotation() {
        if (rotateTimer) {
            clearTimeout(rotateTimer);
            rotateTimer = null;
        }
    }
    
    // Toggle pause
    function togglePause() {
        isPaused = !isPaused;
        
        if (isPaused) {
            stopRotation();
            nonPinnedCards.forEach(c => c.classList.remove('timer-active'));
            if (statusText) statusText.textContent = 'Paused';
            if (pauseBtn) {
                pauseBtn.innerHTML = '<polygon points="5 3 19 12 5 21"></polygon>'; // Play icon
            }
        } else {
            startTimerOnOldest();
            startRotation();
            if (statusText) statusText.textContent = 'Auto-rotating';
            if (pauseBtn) {
                pauseBtn.innerHTML = '<rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect>'; // Pause icon
            }
        }
    }
    
    // Pause on hover
    grid.addEventListener('mouseenter', () => {
        if (!isPaused) {
            stopRotation();
            nonPinnedCards.forEach(c => c.classList.remove('timer-active'));
        }
    });
    
    grid.addEventListener('mouseleave', () => {
        if (!isPaused) {
            startTimerOnOldest();
            startRotation();
        }
    });
    
    // Event listeners
    if (prevBtn) prevBtn.addEventListener('click', rotatePrev);
    if (nextBtn) nextBtn.addEventListener('click', rotateNext);
    if (pauseBtn) pauseBtn.addEventListener('click', togglePause);
    
    // Initialize
    initializeCarousel();
    startRotation();
    
    // Pause when tab is not visible
    document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
            stopRotation();
            nonPinnedCards.forEach(c => c.classList.remove('timer-active'));
        } else if (!isPaused) {
            startTimerOnOldest();
            startRotation();
        }
    });
});

</script>
<script src="{% static 'js/hero-animations.js' %}"></script>
<script>
// Head Message Modal Functions
function openHodModal() {
    const modal = document.getElementById('hodModal');
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

function closeHodModal() {
    const modal = document.getElementById('hodModal');
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = '';
    }
}

// Close modal on backdrop click
document.addEventListener('click', function(event) {
    const modal = document.getElementById('hodModal');
    if (modal && event.target === modal) {
        closeHodModal();
    }
});

// Close modal on Escape key
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        closeHodModal();
    }
});
</script>
<script>
// Researcher Tabs Functionality
document.addEventListener('DOMContentLoaded', function() {
    const tabButtons = document.querySelectorAll('.researcher-tab-btn-home');
    const tabContents = document.querySelectorAll('.researcher-tab-content-home');
    let currentTabIndex = 0;
    let autoSwitchInterval = null;
    
    function switchTab(index) {
        // Remove active class from all buttons and contents
        tabButtons.forEach(btn => btn.classList.remove('active'));
        tabContents.forEach(content => content.classList.remove('active'));
        
        // Add active class to selected button and corresponding content
        if (tabButtons[index] && tabContents[index]) {
            tabButtons[index].classList.add('active');
            tabContents[index].classList.add('active');
            currentTabIndex = index;
        }
    }
    
    function startAutoSwitch() {
        // Clear any existing interval
        if (autoSwitchInterval) {
            clearInterval(autoSwitchInterval);
        }
        
        // Switch tabs every 4 seconds
        autoSwitchInterval = setInterval(function() {
            currentTabIndex = (currentTabIndex + 1) % tabButtons.length;
            switchTab(currentTabIndex);
        }, 4000);
    }
    
    // Manual tab switching
    tabButtons.forEach((button, index) => {
        button.addEventListener('click', function() {
            switchTab(index);
            // Restart auto-switch after manual click
            startAutoSwitch();
        });
    });
    
    // Start auto-switching if tabs exist
    if (tabButtons.length > 0) {
        startAutoSwitch();
        
        // Pause auto-switch on hover, resume on mouse leave
        const tabsContainer = document.querySelector('.researchers-tabs-home');
        if (tabsContainer) {
            tabsContainer.addEventListener('mouseenter', function() {
                if (autoSwitchInterval) {
                    clearInterval(autoSwitchInterval);
                }
            });
            
            tabsContainer.addEventListener('mouseleave', function() {
                startAutoSwitch();
            });
        }
    }
});
</script>
<script>
// Polaroid Card Rotation Animation
(function() {
    const polaroidCards = document.querySelectorAll('.polaroid-frame');

    if (polaroidCards.length >= 3) {
        // Add rotating class to all cards
        polaroidCards.forEach(card => {
            card.classList.add('rotating');
        });

        // Cycle through z-index to create stacking rotation effect
        let currentFront = 0;
        const totalCards = polaroidCards.length;
        let rotationInterval = null;
        let isPaused = false;

        function rotateStack() {
            if (isPaused) return;

            // Remove previous state classes
            polaroidCards.forEach(card => {
                card.classList.remove('moving-back', 'moving-forward');
            });

            // First, apply visual transitions (opacity, blur, scale)
            polaroidCards.forEach((card, index) => {
                const zIndex = (index - currentFront + totalCards) % totalCards;
                const newZIndex = totalCards - zIndex;

                // Add transition classes for smooth visual effect
                if (newZIndex === 1) {
                    // Card going to back - fade and blur
                    card.classList.add('moving-back');
                } else if (newZIndex === totalCards) {
                    // Card coming to front - brighten and focus
                    card.classList.add('moving-forward');
                }
            });

            // Then update z-index after a longer delay to allow smooth visual transition
            setTimeout(() => {
                polaroidCards.forEach((card, index) => {
                    const zIndex = (index - currentFront + totalCards) % totalCards;
                    const newZIndex = totalCards - zIndex;
                    card.style.zIndex = newZIndex.toString();
                    // Also update z-index on parent link if it exists
                    const link = card.closest('.polaroid-link');
                    if (link) {
                        link.style.zIndex = newZIndex.toString();
                    }
                });

                // Remove transition classes after z-index change to allow normal animation
                setTimeout(() => {
                    polaroidCards.forEach(card => {
                        card.classList.remove('moving-back', 'moving-forward');
                    });
                }, 500);
            }, 800);

            // Move to next card
            currentFront = (currentFront + 1) % totalCards;
        }

        function startRotation() {
            if (rotationInterval) clearInterval(rotationInterval);
            isPaused = false;
            rotateStack();
            rotationInterval = setInterval(rotateStack, 7000);
        }

        function stopRotation() {
            if (rotationInterval) {
                clearInterval(rotationInterval);
                rotationInterval = null;
            }
            isPaused = true;
        }

        // Start rotation
        startRotation();

        // Handle hover - bring card to front
        polaroidCards.forEach((card, index) => {
            card.addEventListener('mouseenter', function() {
                // Pause rotation
                stopRotation();
                // Pause all animations
                polaroidCards.forEach(c => {
                    c.style.animationPlayState = 'paused';
                });
                // Bring hovered card to front
                this.style.zIndex = '10';
                const link = this.closest('.polaroid-link');
                if (link) {
                    link.style.zIndex = '10';
                }
            });

            card.addEventListener('mouseleave', function() {
                // Remove transition classes
                polaroidCards.forEach(c => {
                    c.classList.remove('moving-back', 'moving-forward');
                });
                // Resume animations
                polaroidCards.forEach(c => {
                    c.style.animationPlayState = 'running';
                });
                // Resume rotation
                startRotation();
            });
        });
    }
})();
</script>
<script>
// Gallery Showcase Stack (PowerPoint-like slideshow)
{% if gallery_items %}
(function() {
    const stack = document.getElementById('galleryStack');
    const dots = document.querySelectorAll('.gallery-dot');
    const cards = document.querySelectorAll('.gallery-stack-card');
    const modal = document.getElementById('galleryModal');
    const modalBody = document.getElementById('galleryModalBody');
    
    if (!stack || !dots.length || !cards.length) return;
    
    let currentIndex = 0;
    let isAnimating = false;
    let autoRotateInterval = null;
    const totalCards = cards.length;
    
    // Gallery items data (from Django template)
    const galleryItems = [
        {% for item in gallery_items %}
        {
            'title': '{{ item.short_title|escapejs }}',
            'description': '{{ item.description|escapejs|default:"" }}',
            'image': '{{ item.image.url|escapejs }}'
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];
    
    // Update card positions based on current index
    function updateCardPositions() {
        cards.forEach((card, index) => {
            const cardIndex = parseInt(card.dataset.index);
            // Calculate relative position from current index
            let relativePos = cardIndex - currentIndex;
            
            // Handle wrapping for infinite loop
            if (relativePos < 0) {
                relativePos = totalCards + relativePos;
            }
            if (relativePos >= totalCards) {
                relativePos = relativePos - totalCards;
            }
            
            // Apply styles based on position
            if (relativePos === 0) {
                // Front card
                card.style.zIndex = 10;
                card.style.transform = 'translateX(-50%) scale(1)';
                card.style.opacity = '1';
                card.style.filter = 'blur(0px)';
            } else if (relativePos === 1) {
                // First card behind
                card.style.zIndex = 9;
                card.style.transform = 'translateX(-50%) translateX(30px) translateY(20px) scale(0.95)';
                card.style.opacity = '0.85';
                card.style.filter = 'blur(1px)';
            } else if (relativePos === 2) {
                // Second card behind
                card.style.zIndex = 8;
                card.style.transform = 'translateX(-50%) translateX(60px) translateY(40px) scale(0.9)';
                card.style.opacity = '0.7';
                card.style.filter = 'blur(2px)';
            } else if (relativePos === 3) {
                // Third card behind
                card.style.zIndex = 7;
                card.style.transform = 'translateX(-50%) translateX(90px) translateY(60px) scale(0.85)';
                card.style.opacity = '0.55';
                card.style.filter = 'blur(3px)';
            } else if (relativePos === 4) {
                // Fourth card behind
                card.style.zIndex = 6;
                card.style.transform = 'translateX(-50%) translateX(120px) translateY(80px) scale(0.8)';
                card.style.opacity = '0.4';
                card.style.filter = 'blur(4px)';
            } else {
                // Hidden cards
                card.style.opacity = '0';
                card.style.pointerEvents = 'none';
                card.style.zIndex = 5 - relativePos;
            }
        });
    }
    
    // Update active dot
    function updateDots(index) {
        dots.forEach((dot, i) => {
            dot.classList.toggle('active', i === index);
        });
    }
    
    // Go to specific slide
    function goToGallerySlide(index) {
        if (isAnimating || index < 0 || index >= totalCards) return;
        if (index === currentIndex) return;
        
        isAnimating = true;
        currentIndex = index;
        
        updateCardPositions();
        updateDots(currentIndex);
        
        setTimeout(() => {
            isAnimating = false;
        }, 800);
    }
    
    // Next slide
    function nextSlide() {
        if (isAnimating) return;
        goToGallerySlide((currentIndex + 1) % totalCards);
    }
    
    // Previous slide
    function prevSlide() {
        if (isAnimating) return;
        goToGallerySlide((currentIndex - 1 + totalCards) % totalCards);
    }
    
    // Auto-rotate functionality
    function startAutoRotate() {
        if (autoRotateInterval) clearInterval(autoRotateInterval);
        
        autoRotateInterval = setInterval(() => {
            if (!isAnimating) {
                nextSlide();
            }
        }, 5000); // Change slide every 5 seconds
    }
    
    // Pause auto-rotate on hover (entire gallery section)
    const gallerySection = stack.closest('.gallery-showcase-section');
    const galleryWrapper = stack.closest('.gallery-stack-wrapper');
    
    if (gallerySection) {
        gallerySection.addEventListener('mouseenter', () => {
            if (autoRotateInterval) {
                clearInterval(autoRotateInterval);
                autoRotateInterval = null;
            }
        });
        
        gallerySection.addEventListener('mouseleave', () => {
            startAutoRotate();
        });
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
        if (stack.closest('.gallery-showcase-section').offsetParent === null) return; // Section not visible
        
        if (e.key === 'ArrowLeft') {
            e.preventDefault();
            prevSlide();
        } else if (e.key === 'ArrowRight') {
            e.preventDefault();
            nextSlide();
        }
    });
    
    // Touch/swipe support for mobile
    let touchStartX = 0;
    let touchEndX = 0;
    
    stack.addEventListener('touchstart', (e) => {
        touchStartX = e.changedTouches[0].screenX;
    });
    
    stack.addEventListener('touchend', (e) => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
    });
    
    function handleSwipe() {
        const swipeThreshold = 50;
        const diff = touchStartX - touchEndX;
        
        if (Math.abs(diff) > swipeThreshold) {
            if (diff > 0) {
                // Swipe left - next
                nextSlide();
            } else {
                // Swipe right - previous
                prevSlide();
            }
        }
    }
    
    // Make functions available globally
    window.goToGallerySlide = goToGallerySlide;
    window.nextGallerySlide = nextSlide;
    window.prevGallerySlide = prevSlide;
    
    // Open gallery modal
    window.openGalleryModal = function(index) {
        if (index < 0 || index >= galleryItems.length) return;
        
        const item = galleryItems[index];
        modalBody.innerHTML = `
            <img src="${item.image}" alt="${item.title}" class="gallery-modal-image">
            <h2 class="gallery-modal-title">${item.title}</h2>
            ${item.description ? `<p class="gallery-modal-description">${item.description}</p>` : ''}
        `;
        
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
        
        // Update current index
        currentIndex = index;
        updateCardPositions();
        updateDots(index);
    };
    
    // Close gallery modal
    window.closeGalleryModal = function() {
        modal.classList.remove('active');
        document.body.style.overflow = '';
    };
    
    // Close modal on Escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape' && modal.classList.contains('active')) {
            closeGalleryModal();
        }
    });
    
    // Close modal on background click
    modal.addEventListener('click', function(event) {
        if (event.target === modal) {
            closeGalleryModal();
        }
    });
    
    // Initialize
    updateCardPositions();
    updateDots(currentIndex);
    startAutoRotate();
})();
{% endif %}
</script>
{% endblock %}


